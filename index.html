<!DOCTYPE html>

<html lang="ku" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ•Œ Hajiawa Ultra Supreme | Ù†Û•Ø®Ø´Û•ÛŒ Ø²ÛŒØ±Û•Ú©ÛŒ Ù¾ÛØ´Ú©Û•ÙˆØªÙˆÙˆ</title>

<meta name="theme-color" content="#020617">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="description" content="Ø³ÛŒØ³ØªÛ•Ù…ÛŒ Ø²ÛŒØ±Û•Ú©ÛŒ Ù†Û•Ø®Ø´Û•Ø³Ø§Ø²ÛŒ Ø­Ø§Ø¬ÛŒØ§ÙˆØ§ - Ultra Supreme Edition">

<!-- Firebase -->

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

<!-- Core Libraries -->

<script src="https://cdn.tailwindcss.com"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css" />
<script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>

<!-- Prayer Times Library -->

<script src="https://cdn.jsdelivr.net/npm/adhan@4.4.4/PostDist/adhan.min.js"></script>

<!-- Fonts -->

<link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">

<script>
    tailwind.config = {
        theme: {
            extend: {
                colors: {
                    ultra: { 
                        dark: '#020617', 
                        darker: '#0f172a',
                        card: 'rgba(15, 23, 42, 0.85)', 
                        accent: '#3b82f6',
                        gold: '#fbbf24'
                    }
                },
                fontFamily: { 
                    sans: ['Vazirmatn', 'sans-serif'] 
                }
            }
        }
    }
</script>

<style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body, html { 
        height: 100%; margin: 0; padding: 0; background: #020617; overflow: hidden; 
        font-family: 'Vazirmatn', sans-serif;
        -webkit-font-smoothing: antialiased;
    }

    .bg-animated {
        position: fixed; inset: 0;
        background: 
            radial-gradient(circle at 20% 30%, rgba(59, 130, 246, 0.15) 0%, transparent 50%),
            radial-gradient(circle at 80% 70%, rgba(168, 85, 247, 0.1) 0%, transparent 50%);
        animation: pulse-bg 8s ease-in-out infinite;
        pointer-events: none; z-index: 0;
    }
    @keyframes pulse-bg { 
        0%, 100% { opacity: 0.4; } 
        50% { opacity: 0.7; } 
    }

    #map { position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: 1; }
    .leaflet-control-attribution, .leaflet-control-zoom, .leaflet-routing-container { display: none !important; }

    .glass {
        background: rgba(15, 23, 42, 0.88);
        backdrop-filter: blur(24px) saturate(180%);
        border: 1.5px solid rgba(255, 255, 255, 0.15);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), 0 0 60px rgba(59, 130, 246, 0.1);
    }

    .glass-light {
        background: rgba(255, 255, 255, 0.08);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.12);
    }

    .marker-funeral {
        width: 52px; height: 52px;
        background: linear-gradient(135deg, #ef4444, #dc2626);
        border: 4px solid white; border-radius: 50% 50% 50% 0;
        transform: rotate(-45deg);
        display: flex; align-items: center; justify-content: center;
        color: white;
        box-shadow: 0 6px 24px rgba(239, 68, 68, 0.6);
        animation: marker-bounce 2s infinite ease-in-out;
        position: relative; cursor: pointer;
    }

    .marker-funeral::before {
        content: ''; position: absolute; inset: -12px;
        border: 3px solid rgba(239, 68, 68, 0.3);
        border-radius: 50% 50% 50% 0;
        animation: ping 2s cubic-bezier(0, 0, 0.2, 1) infinite;
    }

    .marker-funeral i {
        transform: rotate(45deg); font-size: 22px;
    }

    .marker-mosque {
        width: 40px; height: 40px;
        background: linear-gradient(135deg, #fbbf24, #f59e0b);
        border: 3px solid white; border-radius: 50%;
        display: flex; align-items: center; justify-content: center;
        color: white;
        box-shadow: 0 4px 16px rgba(251, 191, 36, 0.5);
        transition: all 0.3s; cursor: pointer;
    }

    .marker-mosque:hover { transform: scale(1.2); }
    .marker-mosque i { font-size: 18px; }

    @keyframes marker-bounce {
        0%, 100% { transform: translateY(0) rotate(-45deg); }
        50% { transform: translateY(-18px) rotate(-45deg); }
    }

    @keyframes ping {
        0% { transform: scale(1); opacity: 1; }
        75%, 100% { transform: scale(1.8); opacity: 0; }
    }

    .user-marker {
        width: 20px; height: 20px;
        background: linear-gradient(135deg, #3b82f6, #2563eb);
        border: 4px solid white; border-radius: 50%;
        box-shadow: 0 0 30px rgba(59, 130, 246, 0.8);
        animation: pulse-glow 2s ease-in-out infinite;
    }

    @keyframes pulse-glow {
        0%, 100% { box-shadow: 0 0 30px rgba(59, 130, 246, 0.8); }
        50% { box-shadow: 0 0 50px rgba(59, 130, 246, 1); }
    }

    .loader-supreme {
        width: 50px; height: 50px;
        border: 4px solid rgba(59, 130, 246, 0.2);
        border-top-color: #3b82f6;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
    }

    @keyframes spin { to { transform: rotate(360deg); } }

    .modal-container {
        position: fixed; inset: 0;
        background: rgba(0, 0, 0, 0.92);
        backdrop-filter: blur(8px);
        z-index: 7000; display: none;
        align-items: center; justify-content: center;
        padding: 20px;
    }

    .toast-container {
        position: fixed; top: 24px; left: 50%;
        transform: translateX(-50%) translateY(-120px);
        z-index: 8000;
        transition: transform 0.4s;
    }

    .toast-container.show {
        transform: translateX(-50%) translateY(0);
    }

    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.05); border-radius: 10px; }
    ::-webkit-scrollbar-thumb { background: linear-gradient(180deg, #3b82f6, #2563eb); border-radius: 10px; }

    input:focus, select:focus { outline: none; border-color: rgba(59, 130, 246, 0.6) !important; }

    .prayer-next {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(139, 92, 246, 0.2)) !important;
        border: 2px solid rgba(59, 130, 246, 0.5) !important;
        box-shadow: 0 0 24px rgba(59, 130, 246, 0.4) !important;
    }

    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
    }

    @keyframes shimmer {
        0% { background-position: -200% 0; }
        100% { background-position: 200% 0; }
    }
    
    .admin-btn-pulse {
        animation: admin-pulse 2s infinite;
    }
    
    @keyframes admin-pulse {
        0%, 100% { box-shadow: 0 0 0 0 rgba(251, 191, 36, 0.7); }
        50% { box-shadow: 0 0 0 10px rgba(251, 191, 36, 0); }
    }

    .prayer-arabic {
        font-family: 'Amiri', serif !important;
        font-size: 22px !important;
        line-height: 1.8 !important;
        letter-spacing: 0.5px !important;
        text-align: justify !important;
        direction: rtl !important;
    }

    .prayer-kurdish {
        font-family: 'Vazirmatn', sans-serif !important;
        font-size: 14px !important;
        line-height: 1.6 !important;
        text-align: justify !important;
    }
</style>

</head>

<body class="text-white">

<div class="bg-animated"></div>

<!-- Splash Screen -->

<div id="splashScreen" class="fixed inset-0 z-[9999] bg-gradient-to-br from-ultra-dark via-ultra-darker to-purple-950 flex flex-col items-center justify-center transition-opacity duration-700">
    <div class="relative mb-8" style="animation: float 3s ease-in-out infinite;">
        <div class="absolute inset-0 bg-gradient-to-r from-blue-500 to-purple-500 rounded-[32px] blur-3xl opacity-40"></div>
        <div class="relative w-32 h-32 rounded-[32px] bg-gradient-to-br from-blue-500 via-purple-500 to-blue-600 flex items-center justify-center shadow-2xl">
            <i class="fas fa-kaaba text-6xl text-white"></i>
        </div>
    </div>

```
<h1 class="text-5xl font-black tracking-[0.25em] mb-3 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-purple-400 to-blue-400">
    HAJIAWA
</h1>

<div class="flex items-center gap-3 mb-2">
    <div class="h-[2px] w-12 bg-gradient-to-r from-transparent via-blue-500 to-transparent"></div>
    <p class="text-blue-400 text-sm font-bold tracking-[0.3em]">ULTRA SUPREME</p>
    <div class="h-[2px] w-12 bg-gradient-to-r from-transparent via-purple-500 to-transparent"></div>
</div>

<p class="text-gray-500 text-xs font-mono mb-10">Ù†Û•Ø®Ø´Û•ÛŒ Ø²ÛŒØ±Û•Ú©ÛŒ Ù¾ÛØ´Ú©Û•ÙˆØªÙˆÙˆ v7.1 FIXED</p>

<div class="loader-supreme mb-6"></div>

<p id="loadStatus" class="text-gray-400 text-sm font-medium">Ø¬Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ø³ÛŒØ³ØªÛ•Ù…...</p>
```

</div>

<div id="map"></div>

<!-- Top Header -->

<div class="fixed top-0 inset-x-0 z-[5000] p-4 bg-gradient-to-b from-black/90 via-black/60 to-transparent pointer-events-none">
    <div class="flex items-center justify-between pointer-events-auto max-w-2xl mx-auto gap-3 mb-2">
        <div class="glass rounded-2xl px-4 py-2 flex items-center gap-3 shadow-2xl">
            <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center shadow-lg">
                <i class="fas fa-kaaba text-white text-lg"></i>
            </div>
            <div class="hidden sm:block">
                <h1 class="text-sm font-black tracking-tight">HAJIAWA</h1>
                <p class="text-[10px] text-gray-400">Ultra Supreme</p>
            </div>
        </div>

```
    <div class="flex-1 glass rounded-2xl p-3 flex items-center gap-3 shadow-xl max-w-md">
        <i class="fas fa-search text-blue-400 text-sm"></i>
        <input id="searchInput" type="text" oninput="handleSearch()" placeholder="Ú¯Û•Ú•Ø§Ù† Ø¨Û† Ù…Ø²Ú¯Û•ÙˆØª ÛŒØ§Ù† Ù¾Ø±Ø³Û•..." class="bg-transparent border-none outline-none w-full text-sm text-white placeholder-gray-500">
        <button onclick="clearSearch()" class="w-7 h-7 rounded-lg bg-white/5 hover:bg-white/10 flex items-center justify-center transition">
            <i class="fas fa-times text-gray-400 text-xs"></i>
        </button>
    </div>
</div>

<div class="flex items-center justify-between pointer-events-auto max-w-2xl mx-auto gap-2">
    <div class="flex items-center gap-2">
        <button onclick="showAllMosques()" class="w-11 h-11 glass rounded-xl flex items-center justify-center hover:bg-white/10 transition active:scale-95" title="Ù‡Û•Ù…ÙˆÙˆ Ù…Ø²Ú¯Û•ÙˆØªÛ•Ú©Ø§Ù†">
            <i class="fas fa-expand-alt text-green-400"></i>
        </button>
        <button onclick="toggleModal('statsModal')" class="w-11 h-11 glass rounded-xl flex items-center justify-center hover:bg-white/10 transition active:scale-95 relative" title="Ø¦Ø§Ù…Ø§Ø±">
            <i class="fas fa-chart-line text-purple-400"></i>
            <span id="statsNotif" class="absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full text-[10px] font-bold flex items-center justify-center border-2 border-ultra-dark hidden">!</span>
        </button>
        <button onclick="toggleModal('prayerModal')" class="w-11 h-11 glass rounded-xl flex items-center justify-center hover:bg-white/10 transition active:scale-95 relative" title="Ú©Ø§ØªÛŒ Ù†ÙˆÛÚ˜">
            <i class="fas fa-clock text-blue-400"></i>
            <span id="prayerNotif" class="absolute -top-1 -right-1 w-5 h-5 bg-green-500 rounded-full text-[10px] font-bold flex items-center justify-center border-2 border-ultra-dark hidden">1</span>
        </button>
        <button onclick="toggleMapStyleMenu()" class="w-11 h-11 glass rounded-xl flex items-center justify-center hover:bg-white/10 transition active:scale-95" title="Ø¬Û†Ø±ÛŒ Ù†Û•Ø®Ø´Û•">
            <i class="fas fa-map text-orange-400"></i>
        </button>
        <button onclick="toggleModal('adminModal')" class="w-11 h-11 glass rounded-xl flex items-center justify-center hover:bg-white/10 transition active:scale-95 admin-btn-pulse" title="Ø¦Û•Ø¯Ù…ÛŒÙ†">
            <i class="fas fa-shield-alt text-yellow-400"></i>
        </button>
    </div>
    
    <div id="funeralBadge" class="hidden glass rounded-2xl px-4 py-2 flex items-center gap-3 border border-red-500/30 shadow-xl">
        <div class="w-3 h-3 rounded-full bg-red-500 animate-ping absolute"></div>
        <div class="w-3 h-3 rounded-full bg-red-500"></div>
        <span id="funeralCount" class="text-sm font-bold text-red-200">0 Ù¾Ø±Ø³Û•</span>
        <i class="fas fa-hands-praying text-red-400"></i>
    </div>
</div>
```

</div>

<!-- Map Style Menu -->

<div id="mapStyleMenu" class="fixed top-20 right-4 z-[6000] glass p-3 rounded-2xl shadow-2xl hidden">
    <div class="grid grid-cols-2 gap-2">
        <button onclick="changeMapStyle('dark')" class="p-3 rounded-xl bg-gray-800 hover:bg-gray-700 transition flex flex-col items-center gap-1">
            <i class="fas fa-moon text-white text-xl"></i>
            <span class="text-xs">ØªØ§Ø±ÛŒÚ©</span>
        </button>
        <button onclick="changeMapStyle('satellite')" class="p-3 rounded-xl bg-blue-700 hover:bg-blue-600 transition flex flex-col items-center gap-1">
            <i class="fas fa-satellite text-white text-xl"></i>
            <span class="text-xs">Ø³Û•ØªÛ•Ù„Ø§ÛŒØª</span>
        </button>
        <button onclick="changeMapStyle('street')" class="p-3 rounded-xl bg-green-700 hover:bg-green-600 transition flex flex-col items-center gap-1">
            <i class="fas fa-road text-white text-xl"></i>
            <span class="text-xs">Ø´Û•Ù‚Ø§Ù…</span>
        </button>
        <button onclick="changeMapStyle('terrain')" class="p-3 rounded-xl bg-yellow-700 hover:bg-yellow-600 transition flex flex-col items-center gap-1">
            <i class="fas fa-mountain text-white text-xl"></i>
            <span class="text-xs">ØªÛŒØ±ÛÙ†</span>
        </button>
    </div>
</div>

<!-- Bottom Actions -->

<div class="fixed bottom-6 left-1/2 -translate-x-1/2 z-[5000] pointer-events-none">
    <div class="glass p-2.5 rounded-[28px] flex items-center gap-2 pointer-events-auto shadow-2xl">
        <button onclick="locateUser()" class="w-14 h-14 rounded-[20px] bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-xl text-white shadow-lg transition active:scale-90">
            <i class="fas fa-location-crosshairs"></i>
        </button>
        <div class="w-[2px] h-8 bg-white/10"></div>
        <button onclick="toggleModal('janazaModal')" class="w-14 h-14 rounded-[20px] glass-light hover:bg-white/15 flex items-center justify-center text-xl text-green-400 transition active:scale-90">
            <i class="fas fa-book-quran"></i>
        </button>
        <button onclick="shareApp()" class="w-14 h-14 rounded-[20px] glass-light hover:bg-white/15 flex items-center justify-center text-xl text-yellow-400 transition active:scale-90">
            <i class="fas fa-share-nodes"></i>
        </button>
    </div>
</div>

<!-- Detail Card -->

<div id="detailCard" class="fixed bottom-0 inset-x-0 z-[6000] glass rounded-t-[32px] p-6 transform translate-y-full transition-all duration-500 max-h-[70vh] overflow-y-auto">
    <div class="w-20 h-1.5 bg-white/20 rounded-full mx-auto mb-6"></div>

```
<button onclick="closeCard()" class="absolute top-6 left-6 w-10 h-10 rounded-xl glass-light flex items-center justify-center hover:bg-white/20 transition">
    <i class="fas fa-times text-gray-400"></i>
</button>

<div class="flex flex-col items-center mb-6">
    <div class="relative mb-4">
        <div class="absolute inset-0 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full blur-xl opacity-40"></div>
        <div id="cardIcon" class="relative w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full border-4 border-ultra-dark flex items-center justify-center shadow-2xl">
            <i class="fas fa-mosque text-3xl text-white"></i>
        </div>
    </div>
    
    <h2 id="cardTitle" class="text-2xl font-black mb-2 text-center">...</h2>
    <span id="cardDistance" class="hidden px-3 py-1 bg-blue-500/20 border border-blue-500/40 rounded-lg text-blue-300 text-sm font-bold">
        <i class="fas fa-route ml-1"></i>
        <span id="cardDistText">0.0 km</span>
    </span>
</div>

<div id="cardDetails" class="glass-light p-4 rounded-2xl mb-4 hidden">
    <h3 class="font-bold text-sm mb-2 text-blue-400"><i class="fas fa-info-circle ml-1"></i>Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ</h3>
    <p id="cardDescription" class="text-sm text-gray-300"></p>
</div>

<div id="cardFuneralAlert" class="hidden glass-light p-5 rounded-2xl mb-6 border-r-4 border-red-500">
    <div class="flex items-start gap-4">
        <div class="w-12 h-12 bg-red-600 rounded-xl flex items-center justify-center">
            <i class="fas fa-hands-praying text-white text-xl"></i>
        </div>
        <div>
            <h3 class="font-bold text-red-200 text-sm mb-1"><i class="fas fa-exclamation-circle ml-1"></i>Ø¦Ø§Ú¯Ø§Ø¯Ø§Ø±ÛŒ Ù¾Ø±Ø³Û•</h3>
            <p id="cardDeadName" class="text-white font-bold">...</p>
            <p id="cardPrayerTime" class="text-gray-400 text-sm"><i class="fas fa-clock ml-1"></i>...</p>
        </div>
    </div>
</div>

<div class="grid grid-cols-2 gap-3">
    <button onclick="startNavigation()" class="bg-gradient-to-r from-blue-600 to-blue-500 py-4 rounded-2xl font-bold flex items-center justify-center gap-2 shadow-lg">
        <i class="fas fa-location-arrow"></i>Ú•ÛÚ¯Ø§
    </button>
    <button onclick="shareLocation()" class="glass-light py-4 rounded-2xl font-bold flex items-center justify-center gap-2">
        <i class="fas fa-share-nodes"></i>Ù‡Ø§ÙˆØ¨Û•Ø´
    </button>
</div>
```

</div>

<!-- Stats Modal -->

<div id="statsModal" class="modal-container" onclick="if(event.target==this) toggleModal('statsModal')">
    <div class="glass w-full max-w-lg rounded-[32px] p-6 shadow-2xl max-h-[85vh] overflow-y-auto">
        <div class="flex items-center justify-between mb-6">
            <h2 class="text-2xl font-black">Ø¦Ø§Ù…Ø§Ø±</h2>
            <button onclick="toggleModal('statsModal')" class="w-10 h-10 rounded-xl glass-light flex items-center justify-center">
                <i class="fas fa-times text-gray-400"></i>
            </button>
        </div>
        <div class="grid grid-cols-2 gap-4 mb-6">
            <div class="glass-light p-4 rounded-2xl">
                <i class="fas fa-mosque text-4xl text-yellow-400 mb-2"></i>
                <p class="text-3xl font-black" id="totalMosques">0</p>
                <p class="text-xs text-gray-400">Ú©Û†ÛŒ Ù…Ø²Ú¯Û•ÙˆØª</p>
            </div>
            <div class="glass-light p-4 rounded-2xl">
                <i class="fas fa-hands-praying text-4xl text-red-400 mb-2"></i>
                <p class="text-3xl font-black" id="activeFunerals">0</p>
                <p class="text-xs text-gray-400">Ù¾Ø±Ø³Û• Ú†Ø§Ù„Ø§Ú©</p>
            </div>
            <div class="glass-light p-4 rounded-2xl">
                <i class="fas fa-users text-4xl text-blue-400 mb-2"></i>
                <p class="text-3xl font-black">324</p>
                <p class="text-xs text-gray-400">Ø³Û•Ø±Ø¯Ø§Ù†</p>
            </div>
            <div class="glass-light p-4 rounded-2xl">
                <i class="fas fa-map-marked-alt text-4xl text-green-400 mb-2"></i>
                <p class="text-3xl font-black" id="nearbyCount">0</p>
                <p class="text-xs text-gray-400">Ù…Ø²Ú¯Û•ÙˆØªÛŒ Ù†Ø²ÛŒÚ©</p>
            </div>
        </div>
        <div class="glass-light p-5 rounded-2xl">
            <h3 class="font-bold text-sm mb-4 text-blue-400"><i class="fas fa-list-ul ml-1"></i>Ù¾Ø±Ø³Û•Ú©Ø§Ù†ÛŒ Ø¦Û•Ù…Ú•Û†</h3>
            <div id="todayFuneralsList" class="space-y-2"></div>
        </div>
    </div>
</div>

<!-- Prayer Modal -->

<div id="prayerModal" class="modal-container" onclick="if(event.target==this) toggleModal('prayerModal')">
    <div class="glass w-full max-w-md rounded-[32px] p-8 shadow-2xl text-center">
        <div class="w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center shadow-2xl">
            <i class="fas fa-clock text-3xl text-white"></i>
        </div>
        <h2 class="text-2xl font-black mb-4">Ú©Ø§ØªÛŒ Ù†ÙˆÛÚ˜ - Ø­Ø§Ø¬ÛŒØ§ÙˆØ§</h2>
        <div id="currentTime" class="mb-6">
            <div class="text-lg font-mono font-bold">--:--:--</div>
            <div class="text-xs text-gray-400 mt-1">Ø¨Ø§Ø±Ú©Ø±Ø¯Ù†...</div>
        </div>
        <div id="prayerList" class="w-full space-y-2"></div>
        <button onclick="toggleModal('prayerModal')" class="mt-8 text-gray-500 text-sm">Ø¯Ø§Ø®Ø³ØªÙ†</button>
    </div>
</div>

<!-- Janaza Modal -->

<div id="janazaModal" class="modal-container" onclick="if(event.target==this) toggleModal('janazaModal')">
    <div class="glass w-full max-w-lg rounded-[32px] p-6 shadow-2xl max-h-[85vh] overflow-y-auto">
        <div class="flex items-center justify-between mb-6">
            <h2 class="text-2xl font-black flex items-center gap-2">
                <i class="fas fa-book-quran text-green-400"></i>Ù†ÙˆÛÚ˜ÛŒ Ø¬Û•Ù†Ø§Ø²Û•
            </h2>
            <button onclick="toggleModal('janazaModal')" class="w-10 h-10 rounded-xl glass-light flex items-center justify-center">
                <i class="fas fa-times text-gray-400"></i>
            </button>
        </div>

```
    <div class="space-y-4 text-sm">
        <!-- ØªÛ•Ú©Ø¨ÛŒØ±ÛŒ ÛŒÛ•Ú©Û•Ù… -->
        <div class="glass-light p-5 rounded-2xl border-r-4 border-blue-500">
            <div class="flex items-center gap-3 mb-3">
                <div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center shadow-lg">
                    <span class="font-black text-white">Ù¡</span>
                </div>
                <h3 class="font-bold text-blue-400 prayer-kurdish">ØªÛ•Ú©Ø¨ÛŒØ±ÛŒ ÛŒÛ•Ú©Û•Ù…</h3>
                <span class="text-xs text-gray-400 mr-auto prayer-arabic" style="font-size: 16px;">Ø§Ù„Ù„Ù‡ Ø£ÙÙƒÙ’Ø¨ÙØ±</span>
            </div>
            <p class="text-gray-300 mb-2 prayer-kurdish">Ø®ÙˆÛÙ†Ø¯Ù†ÛŒ Ø³ÙˆØ±Û•ØªÛŒ Ø§Ù„ÙØ§ØªØ­Ø© ÙˆÛ•Ú©Ùˆ Ù†ÙˆÛÚ˜ÛŒ Ø¦Ø§Ø¯Û•:</p>
            <p class="prayer-arabic text-blue-200 leading-loose text-justify pb-3 border-b border-blue-900/30">
                Ø¨ÙØ³Ù’Ù…Ù Ù±Ù„Ù„ÙÙ‘Ù‡Ù Ù±Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ€Ù°Ù†Ù Ù±Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù ï´¿Ù¡ï´¾ Ù±Ù„Û¡Ø­ÙÙ…Û¡Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù Ø±ÙØ¨ÙÙ‘ Ù±Ù„Û¡Ø¹ÙÙ€Ù°Ù„ÙÙ…ÙÙŠÙ†Ù ï´¿Ù¢ï´¾ Ù±Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ€Ù°Ù†Ù Ù±Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù ï´¿Ù£ï´¾ Ù…ÙÙ€Ù°Ù„ÙÙƒÙ ÙŠÙÙˆÛ¡Ù…Ù Ù±Ù„Ø¯ÙÙ‘ÙŠÙ†Ù ï´¿Ù¤ï´¾ Ø¥ÙÙŠÙÙ‘Ø§ÙƒÙ Ù†ÙØ¹Û¡Ø¨ÙØ¯Ù ÙˆÙØ¥ÙÙŠÙÙ‘Ø§Ú©Ù Ù†ÙØ³Û¡ØªÙØ¹ÙÙŠÙ†Ù ï´¿Ù¥ï´¾ Ù±Ù‡Û¡Ø¯ÙÙ†ÙØ§ Ù±Ù„ØµÙÙ‘Ø±ÙÙ°Ø·Ù Ù±Ù„Û¡Ù…ÙØ³Û¡ØªÙÙ‚ÙÙŠÙ…Ù ï´¿Ù¦ï´¾ ØµÙØ±ÙÙ°Ø·Ù Ù±Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù Ø£ÙÙ†Û¡Ø¹ÙÙ…Û¡ØªÙ Ø¹ÙÙ„ÙÙŠÛ¡Ù‡ÙÙ…Û¡ ØºÙÙŠÙ’Ø±Ù Ù±Ù„Û¡Ù…ÙØºÙ’Ø¶ÙÙˆØ¨Ù Ø¹ÙÙ„ÙÙŠÙ’Ù‡ÙÙ…Ù’ ÙˆÙÙ„ÙØ§ Ù±Ù„Ø¶ÙÙ‘Ø§Ù„ÙÙ‘ÙŠÙ†Ù ï´¿Ù§ï´¾
            </p>
            <div class="mt-3 p-3 bg-blue-900/20 rounded-lg">
                <p class="text-xs text-blue-300 prayer-kurdish"><i class="fas fa-info-circle ml-1"></i>Ù¾ÛØ´ ØªÛ•Ú©Ø¨ÛŒØ± Ø¯Û•ÚµÛÛŒØª: "Ø§Ù„Ù„Ù‡ Ø£ÙÙƒÙ’Ø¨ÙØ±" Ùˆ Ø¦ÛŒÙ†Ø¬Ø§ Ø¦Û•Ù… Ø³ÙˆØ±Û•ØªÛ• Ø¯Û•Ø®ÙˆÛÙ†ÛŒØª.</p>
            </div>
        </div>

        <!-- ØªÛ•Ú©Ø¨ÛŒØ±ÛŒ Ø¯ÙˆÙˆÛ•Ù… -->
        <div class="glass-light p-5 rounded-2xl border-r-4 border-blue-500">
            <div class="flex items-center gap-3 mb-3">
                <div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center shadow-lg">
                    <span class="font-black text-white">Ù¢</span>
                </div>
                <h3 class="font-bold text-blue-400 prayer-kurdish">ØªÛ•Ú©Ø¨ÛŒØ±ÛŒ Ø¯ÙˆÙˆÛ•Ù…</h3>
                <span class="text-xs text-gray-400 mr-auto prayer-arabic" style="font-size: 16px;">Ø§Ù„Ù„Ù‡ Ø£ÙÙƒÙ’Ø¨ÙØ±</span>
            </div>
            <p class="text-gray-300 mb-2 prayer-kurdish">Ø®ÙˆÛÙ†Ø¯Ù†ÛŒ Ø³Û•ÚµØ§ÙˆØ§ØªÛŒ Ø¦ÛŒØ¨Ø±Ø§Ù‡ÛŒÙ…ÛŒ (Ø¯Ø±ÙˆØ³ØªÛŒ Ø¨Û•Ø³Û•Ø± Ù…Ø­Ù…Ø¯ ï·º):</p>
            <p class="prayer-arabic text-blue-200 leading-loose text-justify pb-3 border-b border-blue-900/30">
                Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ ØµÙÙ„ÙÙ‘ Ø¹ÙÙ„ÙÙ‰ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø¢Ù„Ù Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯ÙØŒ ÙƒÙÙ…ÙØ§ ØµÙÙ„ÙÙ‘ÙŠÙ’ØªÙ Ø¹ÙÙ„ÙÙ‰ Ø¥ÙØ¨Ù’Ø±ÙØ§Ù‡ÙÙŠÙ…Ù ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø¢Ù„Ù Ø¥ÙØ¨Ù’Ø±ÙØ§Ù‡ÙÙŠÙ…ÙØŒ Ø¥ÙÙ†ÙÙ‘ÙƒÙ Ø­ÙÙ…ÙÙŠØ¯ÙŒ Ù…ÙØ¬ÙÙŠØ¯ÙŒ<br>
                Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¨ÙØ§Ø±ÙÙƒÙ’ Ø¹ÙÙ„ÙÙ‰ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø¢Ù„Ù Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯ÙØŒ ÙƒÙÙ…ÙØ§ Ø¨ÙØ§Ø±ÙÙƒÙ’ØªÙ Ø¹ÙÙ„ÙÙ‰ Ø¥ÙØ¨Ù’Ø±ÙØ§Ù‡ÙÙŠÙ…Ù ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø¢Ù„Ù Ø¥ÙØ¨Ù’Ø±ÙØ§Ù‡ÙÙŠÙ…ÙØŒ Ø¥ÙÙ†ÙÙ‘ÙƒÙ Ø­ÙÙ…ÙÙŠØ¯ÙŒ Ù…ÙØ¬ÙÙŠØ¯ÙŒ
            </p>
            <div class="mt-3 p-3 bg-blue-900/20 rounded-lg">
                <p class="text-xs text-blue-300 prayer-kurdish"><i class="fas fa-info-circle ml-1"></i>Ù¾ÛØ´ ØªÛ•Ú©Ø¨ÛŒØ±ÛŒ Ø¯ÙˆÙˆÛ•Ù…: "Ø§Ù„Ù„Ù‡ Ø£ÙÙƒÙ’Ø¨ÙØ±" Ùˆ Ø¦ÛŒÙ†Ø¬Ø§ Ø¦Û•Ù… Ø³Û•ÚµØ§ÙˆØ§ØªÛ• Ø¯Û•Ø®ÙˆÛÙ†ÛŒØª.</p>
            </div>
        </div>

        <!-- ØªÛ•Ú©Ø¨ÛŒØ±ÛŒ Ø³ÛÛŒÛ•Ù… -->
        <div class="glass-light p-5 rounded-2xl border-r-4 border-green-500">
            <div class="flex items-center gap-3 mb-3">
                <div class="w-10 h-10 rounded-full bg-gradient-to-br from-green-500 to-emerald-600 flex items-center justify-center shadow-lg">
                    <span class="font-black text-white">Ù£</span>
                </div>
                <h3 class="font-bold text-green-400 prayer-kurdish">ØªÛ•Ú©Ø¨ÛŒØ±ÛŒ Ø³ÛÛŒÛ•Ù…</h3>
                <span class="text-xs text-gray-400 mr-auto prayer-arabic" style="font-size: 16px;">Ø§Ù„Ù„Ù‡ Ø£ÙÙƒÙ’Ø¨ÙØ±</span>
            </div>
            <p class="text-gray-300 mb-2 prayer-kurdish">Ø¯ÙˆØ¹Ø§ÛŒ Ù…Ø±Ø¯ÙˆÙˆ (Ø¨Û† Ù¾ÛŒØ§Ùˆ):</p>
            <p class="prayer-arabic text-green-200 leading-loose text-justify pb-3 border-b border-green-900/30">
                Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø§ØºÙ’ÙÙØ±Ù’ Ù„ÙÙ‡Ù ÙˆÙØ§Ø±Ù’Ø­ÙÙ…Ù’Ù‡ÙØŒ ÙˆÙØ¹ÙØ§ÙÙÙ‡Ù ÙˆÙØ§Ø¹Ù’ÙÙ Ø¹ÙÙ†Ù’Ù‡ÙØŒ ÙˆÙØ£ÙÙƒÙ’Ø±ÙÙ…Ù’ Ù†ÙØ²ÙÙ„ÙÙ‡ÙØŒ ÙˆÙÙˆÙØ³ÙÙ‘Ø¹Ù’ Ù…ÙØ¯Ù’Ø®ÙÙ„ÙÙ‡ÙØŒ ÙˆÙØ§ØºÙ’Ø³ÙÙ„Ù’Ù‡Ù Ø¨ÙØ§Ù„Ù’Ù…ÙØ§Ø¡Ù ÙˆÙØ§Ù„Ø«ÙÙ‘Ù„Ù’Ø¬Ù ÙˆÙØ§Ù„Ù’Ø¨ÙØ±ÙØ¯ÙØŒ ÙˆÙÙ†ÙÙ‚ÙÙ‘Ù‡Ù Ù…ÙÙ†Ù Ø§Ù„Ù’Ø®ÙØ·ÙØ§ÙŠÙØ§ ÙƒÙÙ…ÙØ§ Ù†ÙÙ‚ÙÙ‘ÙŠÙ’ØªÙ Ø§Ù„Ø«ÙÙ‘ÙˆÙ’Ø¨Ù Ø§Ù„Ù’Ø£ÙØ¨Ù’ÙŠÙØ¶Ù Ù…ÙÙ†Ù Ø§Ù„Ø¯ÙÙ‘Ù†ÙØ³ÙØŒ ÙˆÙØ£ÙØ¨Ù’Ø¯ÙÙ„Ù’Ù‡Ù Ø¯ÙØ§Ø±Ù‹Ø§ Ø®ÙÙŠÙ’Ø±Ù‹Ø§ Ù…ÙÙ†Ù’ Ø¯ÙØ§Ø±ÙÙ‡ÙØŒ ÙˆÙØ£ÙÙ‡Ù’Ù„Ù‹Ø§ Ø®ÙÙŠÙ’Ø±Ù‹Ø§ Ù…ÙÙ†Ù’ Ø£ÙÙ‡Ù’Ù„ÙÙ‡ÙØŒ ÙˆÙØ²ÙÙˆÙ’Ø¬Ù‹Ø§ Ø®ÙÙŠÙ’Ø±Ù‹Ø§ Ù…ÙÙ†Ù’ Ø²ÙÙˆÙ’Ø¬ÙÙ‡ÙØŒ ÙˆÙØ£ÙØ¯Ù’Ø®ÙÙ„Ù’Ù‡Ù Ø§Ù„Ù’Ø¬ÙÙ†ÙÙ‘Ø©ÙØŒ ÙˆÙØ£ÙØ¹ÙØ°Ù’Ù‡Ù Ù…ÙÙ†Ù’ Ø¹ÙØ°ÙØ§Ø¨Ù Ø§Ù„Ù’Ù‚ÙØ¨Ù’Ø±Ù ÙˆÙØ¹ÙØ°ÙØ§Ø¨Ù Ø§Ù„Ù†ÙÙ‘Ø§Ø±Ù
            </p>
            
            <div class="mt-4 p-4 bg-green-900/20 rounded-lg">
                <h4 class="font-bold text-green-300 text-sm mb-2 prayer-kurdish">Ú¯Û†Ú•Ø§Ù†Ú©Ø§Ø±ÛŒ Ø¨Û† Ú˜Ù† Ùˆ Ù…Ù†Ø¯Ø§Úµ:</h4>
                <ul class="text-xs text-green-200 space-y-2 prayer-kurdish">
                    <li class="flex items-start gap-2">
                        <span class="font-bold min-w-[50px]">Ø¨Û† Ú˜Ù†:</span>
                        <span class="prayer-arabic text-sm">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø§ØºÙ’ÙÙØ±Ù’ <span class="text-yellow-300">Ù„ÙÙ‡ÙØ§</span> ÙˆÙØ§Ø±Ù’Ø­ÙÙ…Ù’<span class="text-yellow-300">Ù‡ÙØ§</span></span>
                    </li>
                    <li class="flex items-start gap-2">
                        <span class="font-bold min-w-[50px]">Ø¨Û† Ù…Ù†Ø¯Ø§Úµ:</span>
                        <span class="prayer-arabic text-sm">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø§Ø¬Ù’Ø¹ÙÙ„Ù’Ù‡Ù ÙÙØ±ÙØ·Ù‹Ø§ Ù„ÙÙˆÙØ§Ù„ÙØ¯ÙÙŠÙ’Ù‡Ù ÙˆÙØ³ÙØ¨ÙØ¨Ù‹Ø§ ÙÙÙŠ Ø´ÙÙÙØ§Ø¹ÙØªÙÙ‡ÙÙ…ÙØ§</span>
                    </li>
                    <li class="flex items-start gap-2">
                        <span class="font-bold min-w-[50px]">Ø¨Û† Ú©Û†Ù…Û•Úµ:</span>
                        <span class="prayer-arabic text-sm">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø§ØºÙ’ÙÙØ±Ù’ Ù„ÙÙ‡ÙÙ…Ù’ ÙˆÙØ§Ø±Ù’Ø­ÙÙ…Ù’Ù‡ÙÙ…Ù’</span>
                    </li>
                </ul>
            </div>
        </div>

        <!-- ØªÛ•Ú©Ø¨ÛŒØ±ÛŒ Ú†ÙˆØ§Ø±Û•Ù… -->
        <div class="glass-light p-5 rounded-2xl border-r-4 border-blue-500">
            <div class="flex items-center gap-3 mb-3">
                <div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center shadow-lg">
                    <span class="font-black text-white">Ù¤</span>
                </div>
                <h3 class="font-bold text-blue-400 prayer-kurdish">ØªÛ•Ú©Ø¨ÛŒØ±ÛŒ Ú†ÙˆØ§Ø±Û•Ù…</h3>
                <span class="text-xs text-gray-400 mr-auto prayer-arabic" style="font-size: 16px;">Ø§Ù„Ù„Ù‡ Ø£ÙÙƒÙ’Ø¨ÙØ±</span>
            </div>
            <p class="text-gray-300 mb-2 prayer-kurdish">Ø¯ÙˆØ¹Ø§ÛŒ Ú©Û†ØªØ§ÛŒÛŒ Ùˆ Ø³Û•Ù„Ø§Ù…:</p>
            <p class="prayer-arabic text-blue-200 leading-loose text-justify pb-3 border-b border-blue-900/30">
                Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ù„ÙØ§ ØªÙØ­Ù’Ø±ÙÙ…Ù’Ù†ÙØ§ Ø£ÙØ¬Ù’Ø±ÙÙ‡ÙØŒ ÙˆÙÙ„ÙØ§ ØªÙÙÙ’ØªÙÙ†ÙÙ‘Ø§ Ø¨ÙØ¹Ù’Ø¯ÙÙ‡ÙØŒ ÙˆÙØ§ØºÙ’ÙÙØ±Ù’ Ù„ÙÙ†ÙØ§ ÙˆÙÙ„ÙÙ‡Ù
            </p>
            
            <div class="mt-4">
                <h4 class="font-bold text-yellow-300 mb-2 prayer-kurdish">Ø³Û•Ù„Ø§Ù…Û•Ú©Û•:</h4>
                <p class="prayer-arabic text-white text-center text-lg p-3 bg-white/5 rounded-xl">
                    Ø§Ù„Ø³ÙÙ‘Ù„ÙØ§Ù…Ù Ø¹ÙÙ„ÙÙŠÙ’ÙƒÙÙ…Ù’ ÙˆÙØ±ÙØ­Ù’Ù…ÙØ©Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù ÙˆÙØ¨ÙØ±ÙÙƒÙØ§ØªÙÙ‡Ù
                </p>
            </div>
            
            <div class="mt-4 grid grid-cols-2 gap-3">
                <div class="bg-blue-900/30 p-3 rounded-xl">
                    <h4 class="text-xs font-bold text-blue-300 mb-1 prayer-kurdish">Ø´ÛÙˆØ§Ø²ÛŒ ÛŒÛ•Ú©Û•Ù…:</h4>
                    <p class="text-[11px] text-gray-300 prayer-kurdish">Ø³Û•Ù„Ø§Ù… Ù„Û• Ú•Ø§Ø³ØªÛ•ÙˆÛ• ÛŒÛ•Ú© Ø¬Ø§Ø± Ø¯Û•Ø¯Û•ÛŒØªÛ•ÙˆÛ•</p>
                </div>
                <div class="bg-purple-900/30 p-3 rounded-xl">
                    <h4 class="text-xs font-bold text-purple-300 mb-1 prayer-kurdish">Ø´ÛÙˆØ§Ø²ÛŒ Ø¯ÙˆÙˆÛ•Ù…:</h4>
                    <p class="text-[11px] text-gray-300 prayer-kurdish">Ø³Û•Ù„Ø§Ù… Ù„Û• Ú•Ø§Ø³Øª Ùˆ Ú†Û•Ù¾Û•ÙˆÛ• Ø¯Û•Ø¯Û•ÛŒØªÛ•ÙˆÛ•</p>
                </div>
            </div>
        </div>

        <!-- Ø¯ÙˆØ¹Ø§ Ùˆ ØªÛ•Ø³Ø¨ÛŒØ­ÛŒ Ú©Û†ØªØ§ÛŒÛŒ -->
        <div class="glass-light p-5 rounded-2xl border-r-4 border-purple-500">
            <div class="flex items-center gap-3 mb-3">
                <div class="w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center shadow-lg">
                    <i class="fas fa-hands-praying text-white"></i>
                </div>
                <h3 class="font-bold text-purple-400 prayer-kurdish">Ø¯ÙˆØ¹Ø§ Ùˆ ØªÛ•Ø³Ø¨ÛŒØ­ÛŒ Ø¯ÙˆØ§ÛŒ Ù†ÙˆÛÚ˜</h3>
            </div>
            
            <div class="space-y-3">
                <div class="p-3 bg-purple-900/20 rounded-lg">
                    <h4 class="text-xs font-bold text-purple-300 mb-1 prayer-kurdish">Ø¯ÙˆØ¹Ø§ÛŒ Ú©Û†ØªØ§ÛŒÛŒ:</h4>
                    <p class="prayer-arabic text-purple-200 leading-relaxed">
                        Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø±ÙØ¨ÙÙ‘ÙƒÙ Ø±ÙØ¨ÙÙ‘ Ø§Ù„Ù’Ø¹ÙØ²ÙÙ‘Ø©Ù Ø¹ÙÙ…ÙÙ‘Ø§ ÙŠÙØµÙÙÙÙˆÙ†ÙØŒ ÙˆÙØ³ÙÙ„ÙØ§Ù…ÙŒ Ø¹ÙÙ„ÙÙ‰ Ø§Ù„Ù’Ù…ÙØ±Ù’Ø³ÙÙ„ÙÙŠÙ†ÙØŒ ÙˆÙØ§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù Ø±ÙØ¨ÙÙ‘ Ø§Ù„Ù’Ø¹ÙØ§Ù„ÙÙ…ÙÙŠÙ†Ù
                    </p>
                </div>
                
                <div class="p-3 bg-emerald-900/20 rounded-lg">
                    <h4 class="text-xs font-bold text-emerald-300 mb-1 prayer-kurdish">ØªÛ•Ø³Ø¨ÛŒØ­ÛŒ Ú•Ø§Ø³ØªÛ•Ù‚ÛŒÙ†Û•:</h4>
                    <div class="space-y-2 prayer-kurdish">
                        <div class="flex justify-between items-center">
                            <span class="text-emerald-200">Ù£Ù£ Ø¬Ø§Ø±:</span>
                            <span class="prayer-arabic text-emerald-300">Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-emerald-200">Ù£Ù£ Ø¬Ø§Ø±:</span>
                            <span class="prayer-arabic text-emerald-300">Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-emerald-200">Ù£Ù£ Ø¬Ø§Ø±:</span>
                            <span class="prayer-arabic text-emerald-300">Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø£ÙÙƒÙ’Ø¨ÙØ±Ù</span>
                        </div>
                        <div class="mt-2 pt-2 border-t border-emerald-800/30">
                            <span class="text-emerald-200 block mb-1">Ú©Û†ØªØ§ÛŒÛŒ:</span>
                            <span class="prayer-arabic text-emerald-300 text-sm">Ù„ÙØ§ Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ø§Ù„Ù„ÙÙ‘Ù‡Ù ÙˆÙØ­Ù’Ø¯ÙÙ‡Ù Ù„ÙØ§ Ø´ÙØ±ÙÙŠÙƒÙ Ù„ÙÙ‡ÙØŒ Ù„ÙÙ‡Ù Ø§Ù„Ù’Ù…ÙÙ„Ù’ÙƒÙ ÙˆÙÙ„ÙÙ‡Ù Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù ÙˆÙÙ‡ÙÙˆÙ Ø¹ÙÙ„ÙÙ‰ ÙƒÙÙ„ÙÙ‘ Ø´ÙÙŠÙ’Ø¡Ù Ù‚ÙØ¯ÙÙŠØ±ÙŒ</span>
                        </div>
                    </div>
                </div>
                
                <div class="p-3 bg-amber-900/20 rounded-lg">
                    <h4 class="text-xs font-bold text-amber-300 mb-1 prayer-kurdish">Ø¯ÙˆØ¹Ø§ÛŒ Ø®ÛØ±:</h4>
                    <p class="prayer-arabic text-amber-200">
                        Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø£ÙØ¬ÙØ±Ù’Ù†ÙÙŠ ÙÙÙŠ Ù…ÙØµÙÙŠØ¨ÙØªÙÙŠØŒ ÙˆÙØ§Ø®Ù’Ù„ÙÙÙ’ Ù„ÙÙŠ Ø®ÙÙŠÙ’Ø±Ù‹Ø§ Ù…ÙÙ†Ù’Ù‡ÙØ§
                    </p>
                </div>
            </div>
        </div>

        <!-- ØªÛØ¨ÛŒÙ†ÛŒ Ùˆ ÙÛ•Ø±Ù…Ø§Ù†Û•Ú©Ø§Ù† -->
        <div class="glass-light p-4 rounded-2xl bg-gradient-to-r from-gray-900/50 to-gray-800/50 border border-gray-700">
            <h4 class="font-bold text-yellow-400 text-sm mb-3 flex items-center gap-2 prayer-kurdish">
                <i class="fas fa-lightbulb"></i>ÙÛ•Ø±Ù…Ø§Ù† Ùˆ ØªÛØ¨ÛŒÙ†ÛŒÛ• Ú¯Ø±Ù†Ú¯Û•Ú©Ø§Ù†
            </h4>
            <ul class="text-xs text-gray-300 space-y-2 prayer-kurdish">
                <li class="flex items-start gap-2">
                    <i class="fas fa-check-circle text-green-400 mt-0.5"></i>
                    <span>Ù†ÙˆÛÚ˜ÛŒ Ø¬Û•Ù†Ø§Ø²Û• <span class="text-yellow-300">Ú†ÙˆØ§Ø± ØªÛ•Ú©Ø¨ÛŒØ±</span> Ùˆ <span class="text-yellow-300">Ø³Û ØªÛ•Ú©Ø¨ÛŒØ±</span> Ù‡Û•ÛŒÛ•ØŒ Ø¦Û•Ù…Û• Ú†ÙˆØ§Ø± ØªÛ•Ú©Ø¨ÛŒØ±Û•.</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-check-circle text-green-400 mt-0.5"></i>
                    <span>Ù†ÙˆÛÚ˜ <span class="text-yellow-300">Ø¨Û•Ù‡Û•Ù…ÙˆÙˆ Ù‚ÙˆØ±Ø¦Ø§Ù†ÛÚ©</span> Ø¨Ú©Ø±ÛØª Ø¯Û•ØªÙˆØ§Ù†ÛŒØªØŒ ØªÛ•Ù†Ù‡Ø§ Ø³ÙˆÙˆØ±Û•ØªÛŒ ÙØ§ØªØ­Û• Ù„Û•Ø³Û•Ø± Ù‡Û•Ù…ÙˆÙˆØ§Ù† ÙˆØ§Ø¬Ø¨Û•.</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-check-circle text-green-400 mt-0.5"></i>
                    <span>Ø¦ÛŒÙ…Ø§Ù… Ù„Û• <span class="text-yellow-300">Ø³Û•Ø±ÛŒ Ù…Ø±Ø¯ÙˆÙˆ</span> Ø¯Ø§Ø¯Û•Ù†ÛŒØ´Øª (Ù¾ÛŒØ§Ùˆ Ù„Û• Ø³Û•Ø±ÛŒØŒ Ú˜Ù† Ù„Û• Ù†Ø§ÙˆÛ•Ú•Ø§Ø³ØªÛŒ).</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-check-circle text-green-400 mt-0.5"></i>
                    <span>Ù†ÙˆÛÚ˜ÛŒ Ø¬Û•Ù†Ø§Ø²Û• <span class="text-yellow-300">Ù„Û•Ø³Û•Ø± Ø²Û•ÙˆÛŒ Ù¾Ø§Ú©</span> ÛŒØ§Ù† Ù„Û•Ø³Û•Ø± Ø­Û•Ø³ÛŒØ± Ø¯Û•Ú©Ø±ÛØªØŒ Ù„Û• Ù†Ø§Ùˆ Ù…Ø²Ú¯Û•ÙˆØªØ¯Ø§ Ù†Ø§Ú©Ø±ÛØª.</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-check-circle text-green-400 mt-0.5"></i>
                    <span>Ø¦Û•Ú¯Û•Ø± <span class="text-yellow-300">Ù†Ø²ÛŒÚ©ØªØ±ÛŒÙ† Ø®Ø²Ù…</span> Ø¨ÛØªØŒ Ù„Û• Ù¾ÛØ´Û•ÙˆÛ•ÛŒ Ø¦ÛŒÙ…Ø§Ù… Ø¯Ø§Ø¯Û•Ù†ÛŒØ´Øª.</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-check-circle text-green-400 mt-0.5"></i>
                    <span>Ø¯ÙˆØ§ÛŒ ØªÛ•ÙˆØ§ÙˆØ¨ÙˆÙˆÙ†ÛŒ Ù†ÙˆÛÚ˜ØŒ <span class="text-yellow-300">Ù†Û•Ú©ÙˆØªØ±Ø§</span> Ùˆ Ø¯Û•Ø³Øª Ù…Û•Ú©ÛØ´Û• Ø¨Û•Ø³Û•Ø± Ù…Ø±Ø¯ÙˆÙˆØ¯Ø§.</span>
                </li>
            </ul>
            
            <div class="mt-3 p-3 bg-black/40 rounded-lg">
                <p class="text-xs text-center text-gray-400 prayer-kurdish">
                    <i class="fas fa-info-circle ml-1"></i>
                    Ø¦Û•Ù… Ø¯ÙˆØ¹Ø§ÛŒØ§Ù†Û• Ø¨Û•Ù¾ÛÛŒ Ø³ÙˆÙ†Ù†Û•ØªÛŒ Ù¾ÛØºÛ•Ù…Ø¨Û•Ø± ï·º Ùˆ ÙÛ•Ø±Ù…ÙˆÙˆØ¯Û•ÛŒ Ø¯Û•Ø³ØªÛ•ÚµØ§ØªØ¯Ø§Ø±Ø§Ù†Û•
                </p>
            </div>
        </div>
    </div>
    
    <button onclick="toggleModal('janazaModal')" class="w-full mt-6 py-4 bg-gradient-to-r from-green-600 to-emerald-600 rounded-2xl font-bold shadow-lg hover:opacity-90 transition prayer-kurdish">
        <i class="fas fa-times-circle ml-1"></i>Ø¯Ø§Ø®Ø³ØªÙ†
    </button>
</div>
```

</div>

<!-- Admin Modal -->

<div id="adminModal" class="modal-container" onclick="if(event.target==this) toggleModal('adminModal')">
    <div class="glass w-full max-w-lg rounded-[32px] p-6 shadow-2xl max-h-[85vh] overflow-y-auto">
        <div class="flex items-center justify-between mb-6">
            <h2 class="text-2xl font-black"><i class="fas fa-shield-alt text-blue-400 ml-2"></i>Ø¦Û•Ø¯Ù…ÛŒÙ†</h2>
            <button onclick="toggleModal('adminModal')" class="w-10 h-10 rounded-xl glass-light flex items-center justify-center">
                <i class="fas fa-times text-gray-400"></i>
            </button>
        </div>

```
    <input type="password" id="adminPass" placeholder="ğŸ”’ Ú©Û†Ø¯ÛŒ Ø¦Û•Ø¯Ù…ÛŒÙ†" class="w-full glass-light p-4 rounded-2xl mb-4 outline-none border border-white/10 text-center font-bold placeholder-gray-500">

    <div class="glass-light p-2 rounded-2xl flex gap-2 mb-4">
        <button onclick="showAdminTab('funeral')" id="tabFuneral" class="flex-1 py-3 rounded-xl bg-red-600 font-bold text-sm">
            <i class="fas fa-hands-praying ml-1"></i>Ù¾Ø±Ø³Û•
        </button>
        <button onclick="showAdminTab('mosque')" id="tabMosque" class="flex-1 py-3 rounded-xl text-gray-400 font-bold text-sm">
            <i class="fas fa-mosque ml-1"></i>Ù…Ø²Ú¯Û•ÙˆØª
        </button>
        <button onclick="showAdminTab('edit')" id="tabEdit" class="flex-1 py-3 rounded-xl text-gray-400 font-bold text-sm">
            <i class="fas fa-edit ml-1"></i>Ø¯Û•Ø³ØªÚ©Ø§Ø±ÛŒ
        </button>
    </div>

    <!-- Funeral Form -->
    <div id="funeralForm" class="space-y-3">
        <div class="glass-light p-4 rounded-2xl">
            <h3 class="font-bold text-sm mb-3 text-red-400"><i class="fas fa-plus-circle ml-1"></i>Ù¾Ø±Ø³Û•ÛŒ Ù†ÙˆÛ</h3>
            <select id="mosqueSelect" class="w-full bg-black/30 p-4 rounded-xl outline-none border border-white/10 mb-3"></select>
            <input id="deceasedName" placeholder="Ù†Ø§ÙˆÛŒ Ú©Û†Ú†Ú©Ø±Ø¯ÙˆÙˆ" class="w-full bg-black/30 p-4 rounded-xl outline-none border border-white/10 mb-3">
            <input id="prayerTime" type="time" class="w-full bg-black/30 p-4 rounded-xl outline-none border border-white/10 mb-3">
            <button onclick="submitFuneral()" class="w-full bg-red-600 py-4 rounded-2xl font-bold">
                <i class="fas fa-paper-plane ml-1"></i>Ø¨ÚµØ§ÙˆÚ©Ø±Ø¯Ù†Û•ÙˆÛ•
            </button>
        </div>
        <div class="glass-light p-4 rounded-2xl">
            <h3 class="text-sm font-bold text-red-400 mb-3"><i class="fas fa-list ml-1"></i>Ù¾Ø±Ø³Û• Ú†Ø§Ù„Ø§Ú©Û•Ú©Ø§Ù†</h3>
            <div id="adminFuneralList" class="space-y-2 max-h-48 overflow-y-auto"></div>
        </div>
    </div>

    <!-- Mosque Add Form -->
    <div id="mosqueForm" class="hidden space-y-3">
        <div class="glass-light p-4 rounded-2xl">
            <h3 class="font-bold text-sm mb-3 text-green-400"><i class="fas fa-plus-circle ml-1"></i>Ù…Ø²Ú¯Û•ÙˆØªÛŒ Ù†ÙˆÛ</h3>
            <input id="mosqueName" placeholder="Ù†Ø§ÙˆÛŒ Ù…Ø²Ú¯Û•ÙˆØª" class="w-full bg-black/30 p-4 rounded-xl outline-none border border-white/10 mb-3">
            <div class="grid grid-cols-2 gap-3 mb-3">
                <input id="mosqueLat" placeholder="Lat" class="bg-black/30 p-4 rounded-xl text-center text-xs outline-none border border-white/10">
                <input id="mosqueLng" placeholder="Lng" class="bg-black/30 p-4 rounded-xl text-center text-xs outline-none border border-white/10">
            </div>
            <button onclick="useCurrentLocation()" class="w-full bg-blue-600 py-3 rounded-xl text-sm font-bold mb-3">
                <i class="fas fa-crosshairs ml-1"></i>Ø´ÙˆÛÙ†ÛŒ Ø¦ÛØ³ØªØ§
            </button>
            <button onclick="submitMosque()" class="w-full bg-green-600 py-4 rounded-2xl font-bold">
                <i class="fas fa-plus ml-1"></i>Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†
            </button>
        </div>
    </div>

    <!-- Edit Mosques Form -->
    <div id="editForm" class="hidden space-y-3">
        <div class="glass-light p-4 rounded-2xl">
            <h3 class="font-bold text-sm mb-3 text-blue-400"><i class="fas fa-edit ml-1"></i>Ø¯Û•Ø³ØªÚ©Ø§Ø±ÛŒ Ùˆ Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ù…Ø²Ú¯Û•ÙˆØª</h3>
            <p class="text-xs text-gray-400 mb-3">Ù…Ø²Ú¯Û•ÙˆØªÛŒ Ù‡Û•ÚµØ¨Ú˜ÛØ±Û• Ø¨Û† Ø¯Û•Ø³ØªÚ©Ø§Ø±ÛŒ ÛŒØ§Ù† Ø³Ú•ÛŒÙ†Û•ÙˆÛ•</p>
            <select id="editMosqueSelect" onchange="loadMosqueForEdit()" class="w-full bg-black/30 p-4 rounded-xl outline-none border border-white/10 mb-3">
                <option value="">Ù…Ø²Ú¯Û•ÙˆØªÛÚ© Ù‡Û•ÚµØ¨Ú˜ÛØ±Û•...</option>
            </select>
            
            <div id="editMosqueForm" class="hidden">
                <input id="editMosqueName" placeholder="Ù†Ø§ÙˆÛŒ Ù†ÙˆÛÛŒ Ù…Ø²Ú¯Û•ÙˆØª" class="w-full bg-black/30 p-4 rounded-xl outline-none border border-white/10 mb-3">
                <div class="grid grid-cols-2 gap-3 mb-3">
                    <input id="editMosqueLat" placeholder="Lat" class="bg-black/30 p-4 rounded-xl text-center text-xs outline-none border border-white/10">
                    <input id="editMosqueLng" placeholder="Lng" class="bg-black/30 p-4 rounded-xl text-center text-xs outline-none border border-white/10">
                </div>
                <textarea id="editMosqueDesc" placeholder="Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ Ø²ÛŒØ§Ø¯Û• (Ø¦Ø§Ø±Û•Ø²ÙˆÙˆÙ…Û•Ù†Ø¯Ø§Ù†Û•)" class="w-full bg-black/30 p-4 rounded-xl outline-none border border-white/10 mb-3 text-sm min-h-[80px]"></textarea>
                
                <div class="grid grid-cols-2 gap-3">
                    <button onclick="updateMosque()" class="bg-blue-600 py-4 rounded-2xl font-bold">
                        <i class="fas fa-save ml-1"></i>Ù†ÙˆÛÚ©Ø±Ø¯Ù†Û•ÙˆÛ•
                    </button>
                    <button onclick="deleteMosque()" class="bg-red-600 py-4 rounded-2xl font-bold">
                        <i class="fas fa-trash ml-1"></i>Ø³Ú•ÛŒÙ†Û•ÙˆÛ•
                    </button>
                </div>
            </div>
            
            <div class="mt-4 p-3 bg-blue-900/20 rounded-lg">
                <h4 class="text-xs font-bold text-blue-300 mb-2">ØªÛØ¨ÛŒÙ†ÛŒ:</h4>
                <ul class="text-xs text-gray-300 space-y-1">
                    <li>â€¢ ØªÛ•Ù†Ù‡Ø§ Ù…Ø²Ú¯Û•ÙˆØªÛ•Ú©Ø§Ù†ÛŒ Ø²ÛŒØ§Ø¯Ú©Ø±Ø§Ùˆ (Custom) Ø¯Û•ØªÙˆØ§Ù†Ø±ÛÙ† Ø¯Û•Ø³ØªÚ©Ø§Ø±ÛŒ Ø¨Ú©Ø±ÛÙ†</li>
                    <li>â€¢ Ù…Ø²Ú¯Û•ÙˆØªÛ• Ø¨Ù†Û•Ú•Û•ØªÛŒÛŒÛ•Ú©Ø§Ù†ÛŒ Ø­Ø§Ø¬ÛŒØ§ÙˆØ§ Ù†Ø§ØªÙˆØ§Ù†Ø±ÛÙ† Ø³Ú•Ø¯Ø±ÛÙ†Û•ÙˆÛ•</li>
                    <li>â€¢ Ø´ÙˆÛÙ†ÛŒ Ù†Û•Ø®Ø´Û• Ú©Ù„ÛŒÚ© Ø¨Ú©Û• Ø¨Û† ÙˆÛ•Ø±Ú¯Ø±ØªÙ†ÛŒ Ù¾Û†ØªØ§Ù†Û•Ú©Ø§Ù†</li>
                </ul>
            </div>
        </div>
    </div>
    
    <button onclick="toggleModal('adminModal')" class="w-full mt-4 py-4 glass-light rounded-2xl font-bold">
        Ø¯Ø§Ø®Ø³ØªÙ†
    </button>
</div>
```

</div>

<!-- Toast -->

<div id="toastNotif" class="toast-container">
    <div class="glass px-6 py-3 rounded-2xl flex items-center gap-3 shadow-2xl">
        <i id="toastIcon" class="fas fa-check-circle text-green-400 text-xl"></i>
        <span id="toastMessage" class="text-sm font-bold">Ø³Û•Ø±Ú©Û•ÙˆØªÙˆÙˆ</span>
    </div>
</div>

<script>
    console.log("=== HAJIAWA ULTRA SUPREME v7.1 FIXED ===");

    const firebaseConfig = {
        apiKey: "AIzaSyAoPWYvcDV875kkrU2Op7kSUV2GGmqdUkA",
        authDomain: "hajiawa-map-6fca6.firebaseapp.com",
        databaseURL: "https://hajiawa-map-6fca6-default-rtdb.europe-west1.firebasedatabase.app/",
        projectId: "hajiawa-map-6fca6",
        storageBucket: "hajiawa-map-6fca6.firebasestorage.app",
        messagingSenderId: "631946456317",
        appId: "1:631946456317:web:3e08997a9ec6bd0865a294"
    };

    let map, db, userMarker, routingControl, currentTileLayer;
    let mosques = [];
    let funerals = {};
    let selectedMosque = null;
    let userPos = null;

    // âœ… Ù¾Û†ØªØ§Ù†Û• Ú•Ø§Ø³ØªÛ•Ù‚ÛŒÙ†Û•Ú©Ø§Ù†ÛŒ Ø­Ø§Ø¬ÛŒØ§ÙˆØ§ (Ø¨Û• Ø¯Û•Ù‚ÛŒÙ‚)
    const HAJIAWA_COORDS = {
        latitude: 36.2234,    // Ù¾Û†ØªØ§Ù†ÛŒ Ú•Ø§Ø³ØªÛ•Ù‚ÛŒÙ†Û•ÛŒ Ø­Ø§Ø¬ÛŒØ§ÙˆØ§
        longitude: 44.8166
    };

    const BACKUP_MOSQUES = [
        {id: "m1", name: "Ù…Ø²Ú¯Û•ÙˆØªÛŒ Ú¯Û•ÙˆØ±Û•ÛŒ Ø­Ø§Ø¬ÛŒØ§ÙˆØ§", lat: 36.2369, lng: 44.7869, description: "Ù…Ø²Ú¯Û•ÙˆØªÛŒ Ú¯Û•ÙˆØ±Û•ÛŒ Ø´Ø§Ø±"},
        {id: "m2", name: "Ù…Ø²Ú¯Û•ÙˆØªÛŒ Ø´Û•Ú¾ÛŒØ¯Ø§Ù†", lat: 36.2355, lng: 44.7885},
        {id: "m3", name: "Ù…Ø²Ú¯Û•ÙˆØªÛŒ Ø¯Ø§Ø¨Ø§Ù†", lat: 36.2340, lng: 44.7890},
        {id: "m4", name: "Ù…Ø²Ú¯Û•ÙˆØªÛŒ Ù…Ø§Ú©Û†Ú©", lat: 36.2335, lng: 44.7875},
        {id: "m5", name: "Ù…Ø²Ú¯Û•ÙˆØªÛŒ Ù‚Û•Ù„Ø§ÙˆÛ•ÛŒÛŒØ§Ù†", lat: 36.2320, lng: 44.7860},
        {id: "m12", name: "Ù…Ø²Ú¯Û•ÙˆØªÛŒ Ø´Ø§ÙØ¹ÛŒ Ú¯Û•ÙˆØ±Û•", lat: 36.2410, lng: 44.7880},
        {id: "m21", name: "Ù…Ø²Ú¯Û•ÙˆØªÛŒ Ù†ÙˆØ±", lat: 36.2390, lng: 44.7820},
        {id: "m31", name: "Ù…Ø²Ú¯Û•ÙˆØªÛŒ Ø³Û•Ù„Ø§Ø­Û•Ø¯ÛŒÙ†", lat: 36.2340, lng: 44.7850}
    ];

    // âœ… Ú†Ø§Ø±Û•Ø³Û•Ø±ÛŒ ÛŒÛ•Ú©Û•Ù…: Ú©Ø§ØªÛ•Ú©Ø§Ù†ÛŒ Ù†ÙˆÛÚ˜ÛŒ Ú•Ø§Ø³ØªÛ•Ù‚ÛŒÙ†Û• Ø¨Û† Ø­Ø§Ø¬ÛŒØ§ÙˆØ§
    function updatePrayerTimes() {
        if (typeof adhan === 'undefined') {
            console.warn("Ú©ØªÛØ¨Ø®Ø§Ù†Û•ÛŒ Adhan Ø¨Ø§Ø± Ù†Û•Ø¨ÙˆÙˆÛ•");
            displayFallbackPrayerTimes();
            return;
        }

        try {
            const coordinates = new adhan.Coordinates(
                HAJIAWA_COORDS.latitude, 
                HAJIAWA_COORDS.longitude
            );
            const date = new Date();
            
            // âœ… Ù…ÛŒØªÛ†Ø¯ÛŒ Ú•Ø§Ø³ØªÛ•Ù‚ÛŒÙ†Û•ÛŒ Ø­Ø§Ø¬ÛŒØ§ÙˆØ§: Ø¬ÛŒÙ‡Ø§Ù†ÛŒ Ø¦ÛŒØ³Ù„Ø§Ù…ÛŒ + Ø´Ø§ÙØ¹ÛŒ
            const params = adhan.CalculationMethod.MuslimWorldLeague();
            params.madhab = adhan.Madhab.Shafi;
            
            // âœ… Ø¯Û•Ø³ØªÚ©Ø§Ø±ÛŒ Ø¨Û† Ø­Ø§Ø¬ÛŒØ§ÙˆØ§ (Ø¨Û•Ù¾ÛÛŒ Ù‚Û•Ø²Ø§ÛŒ Ø­Ø§Ø¬ÛŒØ§ÙˆØ§)
            params.adjustments = {
                fajr: 0,      // Ø¨Û•ÛŒØ§Ù†ÛŒ
                sunrise: 0,   // Ø®Û†Ø±Ù‡Û•ÚµØ§Øª
                dhuhr: 2,     // Ù†ÛŒÙˆÛ•Ú•Û†: +2 Ø®ÙˆÙ„Û•Ú©
                asr: 1,       // Ø¹Û•Ø³Ø±: +1 Ø®ÙˆÙ„Û•Ú©
                maghrib: 1,   // Ù…Û•ØºØ±ÛŒØ¨: +1 Ø®ÙˆÙ„Û•Ú©
                isha: 2       // Ø¹ÛŒØ´Ø§: +2 Ø®ÙˆÙ„Û•Ú©
            };

            const prayerTimes = new adhan.PrayerTimes(coordinates, date, params);

            function formatTime(time) {
                let h = time.getHours();
                let m = time.getMinutes();
                return `${h}:${m < 10 ? '0' + m : m}`;
            }

            const prayerSchedule = [
                {key: 'fajr', name: 'Ø¨Û•ÛŒØ§Ù†ÛŒ', time: formatTime(prayerTimes.fajr), icon: 'fa-moon', arabic: 'Ø§Ù„ÙØ¬Ø±'},
                {key: 'sunrise', name: 'Ø®Û†Ø±Ù‡Û•ÚµØ§ØªÙ†', time: formatTime(prayerTimes.sunrise), icon: 'fa-sun', arabic: 'Ø§Ù„Ø´Ø±ÙˆÙ‚'},
                {key: 'dhuhr', name: 'Ù†ÛŒÙˆÛ•Ú•Û†', time: formatTime(prayerTimes.dhuhr), icon: 'fa-sun', arabic: 'Ø§Ù„Ø¸Ù‡Ø±'},
                {key: 'asr', name: 'Ø¹Û•Ø³Ø±', time: formatTime(prayerTimes.asr), icon: 'fa-cloud-sun', arabic: 'Ø§Ù„Ø¹ØµØ±'},
                {key: 'maghrib', name: 'Ù…Û•ØºØ±ÛŒØ¨', time: formatTime(prayerTimes.maghrib), icon: 'fa-moon', arabic: 'Ø§Ù„Ù…ØºØ±Ø¨'},
                {key: 'isha', name: 'Ø¹ÛŒØ´Ø§', time: formatTime(prayerTimes.isha), icon: 'fa-star', arabic: 'Ø§Ù„Ø¹Ø´Ø§Ø¡'}
            ];

            renderPrayerList(prayerSchedule);
        } catch (e) {
            console.error("Ù‡Û•ÚµÛ• Ù„Û• Ø­ÛŒØ³Ø§Ø¨ÛŒ Ù†ÙˆÛÚ˜:", e);
            displayFallbackPrayerTimes();
        }
    }

    function displayFallbackPrayerTimes() {
        const fallback = [
            {key: 'fajr', name: 'Ø¨Û•ÛŒØ§Ù†ÛŒ', time: '05:37', icon: 'fa-moon', arabic: 'Ø§Ù„ÙØ¬Ø±'},
            {key: 'sunrise', name: 'Ø®Û†Ø±Ù‡Û•ÚµØ§ØªÙ†', time: '06:59', icon: 'fa-sun', arabic: 'Ø§Ù„Ø´Ø±ÙˆÙ‚'},
            {key: 'dhuhr', name: 'Ù†ÛŒÙˆÛ•Ú•Û†', time: '12:21', icon: 'fa-sun', arabic: 'Ø§Ù„Ø¸Ù‡Ø±'},
            {key: 'asr', name: 'Ø¹Û•Ø³Ø±', time: '03:11', icon: 'fa-cloud-sun', arabic: 'Ø§Ù„Ø¹ØµØ±'},
            {key: 'maghrib', name: 'Ù…Û•ØºØ±ÛŒØ¨', time: '05:39', icon: 'fa-moon', arabic: 'Ø§Ù„Ù…ØºØ±Ø¨'},
            {key: 'isha', name: 'Ø¹ÛŒØ´Ø§', time: '06:58', icon: 'fa-star', arabic: 'Ø§Ù„Ø¹Ø´Ø§Ø¡'}
        ];
        renderPrayerList(fallback);
    }

    
}

function renderPrayerList(prayerSchedule) {
    const list = document.getElementById('prayerList');
    if (!list) return;

    const now = new Date();
    const currentMinutes = now.getHours() * 60 + now.getMinutes();
    
    let nextPrayerIndex = -1;
    prayerSchedule.forEach((prayer, index) => {
        const [h, m] = prayer.time.split(':').map(Number);
        if (h * 60 + m > currentMinutes && nextPrayerIndex === -1) {
            nextPrayerIndex = index;
        }
    });

    list.innerHTML = ''; // Ø®Ø§ÚµÛŒÚ©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒ Ù„ÛŒØ³ØªÛ•Ú©Û•

    prayerSchedule.forEach((prayer, index) => {
        const [hours, minutes] = prayer.time.split(':').map(Number);
        const prayerMinutes = hours * 60 + minutes;
        
        // --- Ù¡. Ø­ÛŒØ³Ø§Ø¨ÛŒ Ú©Ø§ØªÛŒ Ù…Ø§ÙˆÛ• ---
        let timeRemaining = '';
        if (prayerMinutes > currentMinutes) {
            const remaining = prayerMinutes - currentMinutes;
            const hoursRemaining = Math.floor(remaining / 60);
            const minutesRemaining = remaining % 60;
            timeRemaining = hoursRemaining > 0 ? `${hoursRemaining}Ú© ${minutesRemaining}Ø®` : `${minutesRemaining}Ø®`;
        } else {
            timeRemaining = 'ØªÛ•ÙˆØ§Ùˆ Ø¨ÙˆÙˆ';
        }
        
        // --- Ù¢. Ø­ÛŒØ³Ø§Ø¨ÛŒ Ú©Ø§ØªÛŒ Ù‡Û•ÛŒÙ†ÛŒ Ùˆ Ú©Ø§ØªÛŒ Ø¦Û•Ø³Úµ ---
        let displayTime = prayer.time;
        if (prayer.key === 'dhuhr' && now.getDay() === 5) {
            const h = parseInt(prayer.time.split(':')[0]);
            const m = parseInt(prayer.time.split(':')[1]) + 30;
            const newHours = h + Math.floor(m / 60);
            const newMinutes = m % 60;
            displayTime = `${newHours}:${newMinutes < 10 ? '0' : ''}${newMinutes}`;
        }

        // --- Ù£. Ú¯Û†Ú•ÛŒÙ† Ø¨Û† Ù¡Ù¢ Ø³Û•Ø¹Ø§ØªÛŒ (Ú¯Ø±Ù†Ú¯ØªØ±ÛŒÙ† Ø¨Û•Ø´) ---
        // Ù„ÛØ±Û•Ø¯Ø§ Ú©Ø§ØªÛ•Ú©Û• Ø¯Û•Ú¯Û†Ú•ÛŒÙ† Ùˆ Ø¯Û•ÛŒÚ©Û•ÛŒÙ†Û• Ú¯Û†Ú•Ø§ÙˆÛÚ©ÛŒ Ù†ÙˆÛ Ø¨Û•Ù†Ø§ÙˆÛŒ finalTime
        let finalTime = convertTo12Hour(displayTime);


        // --- Ù¤. Ø¯Ø±ÙˆØ³ØªÚ©Ø±Ø¯Ù†ÛŒ HTML ---
        // Ø¯ÚµÙ†ÛŒØ§Ø¨Û• Ù„ÛØ±Û•Ø¯Ø§ `finalTime` Ø¨Û•Ú©Ø§Ø±Ø¯ÛÙ†ÛŒØª Ù†Û•Ú© `prayer.time`
        
        const li = document.createElement('li');
        // Ø¦Û•Ú¯Û•Ø± Ø¯ÛŒØ²Ø§ÛŒÙ†Û•Ú©Û•Øª class-ÛŒ ØªØ§ÛŒØ¨Û•ØªÛŒ Ù‡Û•ÛŒÛ• Ø¨Û† Ù†ÙˆÛÚ˜ÛŒ Ø¯Ø§Ù‡Ø§ØªÙˆÙˆØŒ Ù„ÛØ±Û• Ø²ÛŒØ§Ø¯ÛŒ Ø¨Ú©Û•
        if (index === nextPrayerIndex) {
            li.classList.add('active'); // ÛŒØ§Ù† Ù‡Û•Ø± Ù†Ø§ÙˆÛÚ© Ú©Û• Ø®Û†Øª Ø¨Û•Ú©Ø§Ø±Øª Ù‡ÛÙ†Ø§ÙˆÛ•
        }

        li.innerHTML = `
            <div class="prayer-item">
                <span class="icon"><i class="fas ${prayer.icon}"></i></span>
                <span class="name">${prayer.name}</span>
                <span class="time" style="direction: ltr;">${finalTime}</span>
                <span class="remaining">${timeRemaining}</span>
            </div>
        `;
        
        // Ø¦Û•Ú¯Û•Ø± Ø´ÛÙˆØ§Ø²ÛŒ HTML-Û•Ú©Û•Øª Ø¬ÛŒØ§ÙˆØ§Ø²Û•ØŒ ØªÚ©Ø§ÛŒÛ• Ú©Û†Ø¯ÛŒ HTML-ÛŒ Ø®Û†Øª Ù„ÛØ±Û• Ø¯Ø§Ø¨Ù†Û
        // Ø¨Û•ÚµØ§Ù… Ù„Û•Ø¬ÛŒØ§ØªÛŒ ${prayer.time} Ø¨Ù†ÙˆÙˆØ³Û• ${finalTime}

        list.appendChild(li);
    });

        function convertTo12Hour(time) {
    let [h, m] = time.split(':').map(Number);
    let period = h >= 12 ? 'PM' : 'AM';
    h = h % 12;
    h = h ? h : 12; // Ø¦Û•Ú¯Û•Ø± Ù  Ø¨ÙˆÙˆ Ø¨ÛŒÚ©Û• Ø¨Û• Ù¡Ù¢
    return `${h}:${m < 10 ? '0' + m : m} ${period}`;
}

}

            
            list.innerHTML += `
                <div class="flex justify-between items-center p-4 rounded-2xl ${isNext ? 'prayer-next' : 'glass-light'} transition-all">
                    <div class="flex items-center gap-3">
                        <div class="w-11 h-11 rounded-xl bg-gradient-to-br ${isNext ? 'from-blue-500 to-purple-500' : 'from-white/10 to-white/5'} flex items-center justify-center shadow-lg">
                            <i class="fas ${prayer.icon} ${isNext ? 'text-white' : 'text-gray-400'}"></i>
                        </div>
                        <div>
                            <div class="flex items-center gap-2">
                                <span class="font-bold text-sm ${isNext ? 'text-white' : 'text-gray-300'}">${prayer.name}</span>
                                ${isNext ? '<span class="text-xs bg-blue-500/40 px-2 py-0.5 rounded-lg text-blue-200">Ø¯Ø§Ù‡Ø§ØªÙˆÙˆ</span>' : ''}
                            </div>
                            <span class="block text-[10px] ${isNext ? 'text-blue-300' : 'text-gray-500'} mt-0.5">${prayer.arabic}</span>
                        </div>
                    </div>
                    <div class="text-right">
                        <span class="font-mono text-lg font-bold ${isNext ? 'text-blue-200' : 'text-gray-400'} block">${displayTime}</span>
                        <span class="text-xs ${isNext ? 'text-blue-300' : 'text-gray-500'} font-mono">${timeRemaining}</span>
                    </div>
                </div>
            `;
        });
        
        if (nextPrayerIndex !== -1) {
            const nextPrayer = prayerSchedule[nextPrayerIndex];
            const notif = document.getElementById('prayerNotif');
            if(notif) {
                notif.textContent = nextPrayer.name;
                notif.classList.remove('hidden');
            }
        }
        
        // ØªÛØ¨ÛŒÙ†ÛŒ
        const note = document.createElement('div');
        note.className = 'mt-4 p-3 bg-blue-900/20 rounded-xl border border-blue-800/30';
        note.innerHTML = `
            <p class="text-xs text-blue-300 text-center">
                <i class="fas fa-map-marker-alt ml-1"></i>
                Ú©Ø§ØªÛ•Ú©Ø§Ù† Ø¨Û† Ø­Ø§Ø¬ÛŒØ§ÙˆØ§ - Ù…ÛŒØªÛ†Ø¯ÛŒ Ø¬ÛŒÙ‡Ø§Ù†ÛŒ Ø¦ÛŒØ³Ù„Ø§Ù…ÛŒ - Ù…Û•Ø²Ù‡Û•Ø¨ÛŒ Ø´Ø§ÙØ¹ÛŒ
            </p>
        `;
        list.appendChild(note);
    }

    function updateCurrentTimeDisplay() {
        const container = document.getElementById('currentTime');
        if (!container) return;

        const now = new Date();
        const timeString = now.toLocaleTimeString('en-US', { hour12: false });
        
        const kurdishDays = ['ÛŒÛ•Ú©Ø´Û•Ù…Ù…Û•', 'Ø¯ÙˆÙˆØ´Û•Ù…Ù…Û•', 'Ø³ÛØ´Û•Ù…Ù…Û•', 'Ú†ÙˆØ§Ø±Ø´Û•Ù…Ù…Û•', 'Ù¾ÛÙ†Ø¬Ø´Û•Ù…Ù…Û•', 'Ù‡Û•ÛŒÙ†ÛŒ', 'Ø´Û•Ù…Ù…Û•'];
        const kurdishMonths = ['Ú©Ø§Ù†ÙˆÙˆÙ†ÛŒ Ø¯ÙˆÙˆÛ•Ù…', 'Ø´ÙˆØ¨Ø§Øª', 'Ø¦Ø§Ø²Ø§Ø±', 'Ù†ÛŒØ³Ø§Ù†', 'Ø¦Ø§ÛŒØ§Ø±', 'Ø­ÙˆØ²Û•ÛŒØ±Ø§Ù†', 'ØªÛ•Ù…ÙˆÙˆØ²', 'Ø¦Ø§Ø¨', 'Ø¦Û•ÛŒÙ„ÙˆÙˆÙ„', 'ØªØ´Ø±ÛŒÙ†ÛŒ ÛŒÛ•Ú©Û•Ù…', 'ØªØ´Ø±ÛŒÙ†ÛŒ Ø¯ÙˆÙˆÛ•Ù…', 'Ú©Ø§Ù†ÙˆÙˆÙ†ÛŒ ÛŒÛ•Ú©Û•Ù…'];
        
        const dayName = kurdishDays[now.getDay()];
        const monthName = kurdishMonths[now.getMonth()];
        const year = now.getFullYear();
        const day = now.getDate();
        const dateString = `${dayName}ØŒ ${day} ${monthName} ${year}`;

        container.innerHTML = `
            <div class="text-3xl font-mono font-black text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-400 tracking-wider">${timeString}</div>
            <div class="text-sm text-gray-400 mt-2">${dateString}</div>
        `;
    }

    // âœ… Ú†Ø§Ø±Û•Ø³Û•Ø±ÛŒ Ø¯ÙˆÙˆÛ•Ù…: Ø¨Ø§Ø´ØªØ±Ú©Ø±Ø¯Ù†ÛŒ Ø®ÛØ±Ø§ÛŒÛŒ Ùˆ Ú†Ø§Ø±Û•Ø³Û•Ø±ÛŒ Ú¯ÚµÛŒÚ†
    window.addEventListener('load', async () => {
        console.log("ğŸš€ Ø¯Û•Ø³ØªÙ¾ÛÚ©Ø±Ø¯Ù†...");

        const removeSplash = () => {
            const splash = document.getElementById('splashScreen');
            if(splash) {
                splash.style.opacity = '0';
                setTimeout(() => splash.style.display = 'none', 500);
            }
        };

        // âœ… ØªØ§ÛŒÙ… Ø¦Ø§ÙˆØª: Ø¯ÙˆØ§ÛŒ 2.5 Ú†Ø±Ú©Û• splash Ù„Ø§Ø¨Ø¨Û•
        setTimeout(removeSplash, 2500);

        try {
            // âœ… ÛŒÛ•Ú©Û•Ù…: Ú©Ø§ØªÛ•Ú©Ø§Ù†ÛŒ Ù†ÙˆÛÚ˜ Ø¨Ø§Ø±Ú©Û•Ø±Û•ÙˆÛ• (Ø¨Û•Ø¨Û Ø¦ÛŒÙ†ØªÛ•Ø±Ù†ÛØªÛŒØ´ Ú©Ø§Ø± Ø¯Û•Ú©Ø§Øª)
            updatePrayerTimes();
            setInterval(updatePrayerTimes, 60000);
            setInterval(updateCurrentTimeDisplay, 1000);
            updateCurrentTimeDisplay();

            // âœ… Ø¯ÙˆÙˆÛ•Ù…: Ù†Û•Ø®Ø´Û•
            initMap();

            // âœ… Ø³ÛÛŒÛ•Ù…: Firebase Ø¨Û• timeout
            try {
                const app = firebase.initializeApp(firebaseConfig);
                db = firebase.database();
                console.log("âœ… Firebase Ú¯Ø±ÛØ¯Ø±Ø§ÙˆÛ•");
            } catch(e) {
                console.warn("âš ï¸ Firebase Ø¨Ø§Ø± Ù†Û•Ø¨ÙˆÙˆØŒ Ø¦Û†ÙÙ„Ø§ÛŒÙ† Ù…Û†Ø¯");
                db = null;
            }

            // âœ… Ú†ÙˆØ§Ø±Û•Ù…: Ø¨Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ù…Ø²Ú¯Û•ÙˆØªÛ•Ú©Ø§Ù† Ø¨Û• timeout
            await Promise.race([
                loadMosques(),
                new Promise((_, reject) => setTimeout(() => reject(new Error('timeout')), 8000))
            ]).catch(e => {
                console.warn("âš ï¸ Ø¨Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ù…Ø²Ú¯Û•ÙˆØªÛ•Ú©Ø§Ù† Ú©Ø§Øª Ø¨Û•Ø³Û•Ø±Ú†ÙˆÙˆ");
                mosques = BACKUP_MOSQUES;
                renderMarkers();
                updateStats();
            });

            autoDeleteOldFunerals();
            setTimeout(removeSplash, 800);

        } catch (error) {
            console.error("âŒ Ù‡Û•ÚµÛ•:", error);
            mosques = BACKUP_MOSQUES;
            renderMarkers();
            updateStats();
            removeSplash();
        }
    });

    function initMap() {
        try {
            map = L.map('map', {
                zoomControl: false,
                attributionControl: false,
                minZoom: 12,
                maxZoom: 20
            }).setView([36.2369, 44.7869], 14);

            const darkLayer = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {maxZoom: 20});
            darkLayer.addTo(map);
            currentTileLayer = darkLayer;

            window.mapLayers = {
                dark: darkLayer,
                satellite: L.tileLayer('https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {maxZoom: 20}),
                street: L.tileLayer('https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {maxZoom: 20}),
                terrain: L.tileLayer('https://mt1.google.com/vt/lyrs=p&x={x}&y={y}&z={z}', {maxZoom: 20})
            };
            
            map.locate({setView: true, maxZoom: 15});
            map.on('locationfound', (e) => {
                userPos = e.latlng;
                if(userMarker) map.removeLayer(userMarker);
                userMarker = L.marker(e.latlng, {
                    icon: L.divIcon({
                        className: 'bg-transparent',
                        html: '<div class="user-marker"></div>',
                        iconSize: [20, 20],
                        iconAnchor: [10, 10]
                    })
                }).addTo(map);
                updateNearbyCount();
            });

            map.on('locationerror', () => console.log('Ø´ÙˆÛÙ† Ù†Û•Ø¯Û†Ø²Ø±Ø§ÛŒÛ•ÙˆÛ•'));
            map.on('click', (e) => {
                document.getElementById('mosqueLat').value = e.latlng.lat.toFixed(6);
                document.getElementById('mosqueLng').value = e.latlng.lng.toFixed(6);
                document.getElementById('editMosqueLat').value = e.latlng.lat.toFixed(6);
                document.getElementById('editMosqueLng').value = e.latlng.lng.toFixed(6);
            });
        } catch(e) {
            console.error("âŒ Ù‡Û•ÚµÛ• Ù„Û• Ù†Û•Ø®Ø´Û•:", e);
        }
    }

    function changeMapStyle(style) {
        if(currentTileLayer) map.removeLayer(currentTileLayer);
        const layer = window.mapLayers[style];
        if(layer) {
            layer.addTo(map);
            currentTileLayer = layer;
            showToast(`Ú¯Û†Ú•Ø¯Ø±Ø§ Ø¨Û† ${style}`);
        }
        toggleMapStyleMenu();
    }

    function toggleMapStyleMenu() {
        const menu = document.getElementById('mapStyleMenu');
        menu.classList.toggle('hidden');
    }

    async function loadMosques() {
        console.log("ğŸš€ Ø¨Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ù…Ø²Ú¯Û•ÙˆØªÛ•Ú©Ø§Ù†...");
        
        try {
            // âœ… OSM Ø¨Û• timeout
            let osmMosques = [];
            const query = `[out:json];node["amenity"="place_of_worship"]["religion"="muslim"](36.21,44.75,36.26,44.83);out;`;
            
            try {
                const response = await Promise.race([
                    fetch('https://overpass-api.de/api/interpreter', {method: 'POST', body: query}),
                    new Promise((_, reject) => setTimeout(() => reject(new Error('OSM timeout')), 5000))
                ]);
                
                const data = await response.json();
                osmMosques = data.elements.map(e => ({
                    id: 'osm_' + e.id,
                    name: e.tags['name:ckb'] || e.tags.name || 'Ù…Ø²Ú¯Û•ÙˆØª',
                    lat: e.lat,
                    lng: e.lon
                }));
                console.log(`âœ… ${osmMosques.length} Ù…Ø²Ú¯Û•ÙˆØª Ù„Û• OSM`);
            } catch(e) {
                console.warn("âš ï¸ OSM Ú©Ø§Ø± Ù†Û•Ú©Ø±Ø¯");
            }

            // âœ… Firebase
            if(db) {
                db.ref('customMosques').on('value', (snap) => {
                    const custom = snap.val() ? Object.values(snap.val()) : [];
                    const all = [...BACKUP_MOSQUES, ...osmMosques, ...custom];
                    mosques = all.filter((m, i, a) => a.findIndex(t => t.id === m.id) === i);
                    console.log(`ğŸ¯ Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ: ${mosques.length} Ù…Ø²Ú¯Û•ÙˆØª`);
                    renderMarkers();
                    updateAdminSelect();
                    updateEditMosqueSelect();
                    updateStats();
                });

                db.ref('funerals').on('value', (snap) => {
                    funerals = snap.val() || {};
                    renderMarkers();
                    updateStats();
                    updateHeaderBadge();
                    updateAdminFuneralList();
                });
            } else {
                mosques = [...BACKUP_MOSQUES, ...osmMosques];
                renderMarkers();
                updateStats();
            }
            
        } catch(e) {
            console.error("âŒ Ù‡Û•ÚµÛ• Ù„Û• Ø¨Ø§Ø±Ú©Ø±Ø¯Ù†:", e);
            mosques = BACKUP_MOSQUES;
            renderMarkers();
            updateStats();
        }
    }

    function renderMarkers() {
        map.eachLayer(l => {
            if(l instanceof L.Marker && l !== userMarker) map.removeLayer(l);
        });

        mosques.forEach(m => {
            const hasFun = funerals[m.id];
            const icon = L.divIcon({
                className: 'bg-transparent',
                html: hasFun ? '<div class="marker-funeral"><i class="fas fa-hands-praying"></i></div>' : '<div class="marker-mosque"><i class="fas fa-moon"></i></div>',
                iconSize: hasFun ? [52,52] : [40,40],
                iconAnchor: hasFun ? [26,52] : [20,20]
            });
            L.marker([m.lat, m.lng], {icon}).addTo(map).on('click', () => openDetailCard(m, hasFun));
        });
    }

    function openDetailCard(m, fun) {
        selectedMosque = m;
        document.getElementById('cardTitle').textContent = m.name;
        
        const iconDiv = document.getElementById('cardIcon');
        if(fun) {
            iconDiv.className = 'relative w-20 h-20 bg-gradient-to-br from-red-500 to-red-600 rounded-full border-4 border-ultra-dark flex items-center justify-center shadow-2xl';
            iconDiv.innerHTML = '<i class="fas fa-hands-praying text-3xl text-white"></i>';
        } else {
            iconDiv.className = 'relative w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full border-4 border-ultra-dark flex items-center justify-center shadow-2xl';
            iconDiv.innerHTML = '<i class="fas fa-mosque text-3xl text-white"></i>';
        }

        if(userPos) {
            const dist = (map.distance(userPos, [m.lat, m.lng]) / 1000).toFixed(1);
            document.getElementById('cardDistText').textContent = dist + ' km';
            document.getElementById('cardDistance').classList.remove('hidden');
        } else {
            document.getElementById('cardDistance').classList.add('hidden');
        }

        const detDiv = document.getElementById('cardDetails');
        if(m.description) {
            detDiv.classList.remove('hidden');
            document.getElementById('cardDescription').textContent = m.description;
        } else {
            detDiv.classList.add('hidden');
        }

        const alert = document.getElementById('cardFuneralAlert');
        if(fun) {
            alert.classList.remove('hidden');
            document.getElementById('cardDeadName').textContent = fun.name;
            document.getElementById('cardPrayerTime').textContent = 'Ú©Ø§Øª: ' + fun.time;
        } else {
            alert.classList.add('hidden');
        }

        document.getElementById('detailCard').style.transform = 'translateY(0)';
        map.flyTo([m.lat, m.lng], 16, {duration: 1.2});
    }

    function closeCard() {
        document.getElementById('detailCard').style.transform = 'translateY(100%)';
        if(routingControl) {
            map.removeControl(routingControl);
            routingControl = null;
        }
    }

    function startNavigation() {
        if(!userPos) return showToast('Ø´ÙˆÛÙ† Ù†Û•Ø¯Û†Ø²Ø±Ø§ÛŒÛ•ÙˆÛ•', 'error');
        if(!selectedMosque) return showToast('Ù‡Û•ÚµØ¨Ú˜ÛØ±Û•', 'error');
        
        closeCard();
        if(routingControl) map.removeControl(routingControl);
        
        routingControl = L.Routing.control({
            waypoints: [L.latLng(userPos.lat, userPos.lng), L.latLng(selectedMosque.lat, selectedMosque.lng)],
            lineOptions: {styles: [{color: '#3b82f6', opacity: 0.9, weight: 6}]},
            createMarker: () => null,
            show: false
        }).addTo(map);
        
        showToast('Ú•ÛÚ¯Ø§Ú©ÛØ´Ø§Ù† Ø¯Û•Ø³ØªÛŒ Ù¾ÛÚ©Ø±Ø¯');
    }

    function handleSearch() {
        const q = document.getElementById('searchInput').value.toLowerCase().trim();
        if(q.length < 2) return;
        const found = mosques.find(m => m.name.toLowerCase().includes(q));
        if(found) {
            map.flyTo([found.lat, found.lng], 17);
            setTimeout(() => openDetailCard(found, funerals[found.id]), 1500);
        } else {
            showToast('Ù†Û•Ø¯Û†Ø²Ø±Ø§ÛŒÛ•ÙˆÛ•', 'error');
        }
    }

    function clearSearch() {
        document.getElementById('searchInput').value = '';
    }

    function updateStats() {
        document.getElementById('totalMosques').textContent = mosques.length;
        document.getElementById('activeFunerals').textContent = Object.keys(funerals).length;
        updateNearbyCount();
        updateTodayFuneralsList();
    }

    function updateNearbyCount() {
        if(!userPos) {
            document.getElementById('nearbyCount').textContent = '0';
            return;
        }
        const nearby = mosques.filter(m => map.distance(userPos, [m.lat, m.lng]) <= 2000);
        document.getElementById('nearbyCount').textContent = nearby.length;
    }

    function updateTodayFuneralsList() {
        const list = document.getElementById('todayFuneralsList');
        list.innerHTML = '';
        const count = Object.keys(funerals).length;
        if(count === 0) {
            list.innerHTML = '<p class="text-center text-gray-500 text-sm py-3">Ù‡ÛŒÚ† Ù¾Ø±Ø³Û•ÛŒÛ•Ú© Ù†ÛŒÛŒÛ•</p>';
            return;
        }
        Object.entries(funerals).forEach(([id, data]) => {
            const m = mosques.find(x => x.id == id);
            if(!m) return;
            const div = document.createElement('div');
            div.className = 'glass-light p-3 rounded-xl flex justify-between';
            div.innerHTML = `<div><p class="text-xs font-bold text-white">${m.name}</p><p class="text-xs text-gray-400">${data.name}</p></div><span class="text-xs text-blue-400 font-mono">${data.time}</span>`;
            list.appendChild(div);
        });
    }

    function updateHeaderBadge() {
        const count = Object.keys(funerals).length;
        const badge = document.getElementById('funeralBadge');
        if(count > 0) {
            badge.classList.remove('hidden');
            badge.classList.add('flex');
            document.getElementById('funeralCount').textContent = count + ' Ù¾Ø±Ø³Û•';
            document.getElementById('statsNotif').classList.remove('hidden');
        } else {
            badge.classList.add('hidden');
            document.getElementById('statsNotif').classList.add('hidden');
        }
    }

    function showAllMosques() {
        if(mosques.length === 0) return showToast('Ù‡ÛŒÚ† Ù…Ø²Ú¯Û•ÙˆØªÛÚ© Ù†ÛŒÛŒÛ•', 'error');
        const bounds = L.latLngBounds();
        mosques.forEach(m => bounds.extend([m.lat, m.lng]));
        map.fitBounds(bounds, {padding: [50, 50]});
        showToast(`${mosques.length} Ù…Ø²Ú¯Û•ÙˆØª`);
    }

    function showAdminTab(tab) {
        const ff = document.getElementById('funeralForm');
        const mf = document.getElementById('mosqueForm');
        const ef = document.getElementById('editForm');
        const tf = document.getElementById('tabFuneral');
        const tm = document.getElementById('tabMosque');
        const te = document.getElementById('tabEdit');
        
        ff.classList.add('hidden');
        mf.classList.add('hidden');
        ef.classList.add('hidden');
        
        tf.className = 'flex-1 py-3 rounded-xl text-gray-400 font-bold text-sm';
        tm.className = 'flex-1 py-3 rounded-xl text-gray-400 font-bold text-sm';
        te.className = 'flex-1 py-3 rounded-xl text-gray-400 font-bold text-sm';
        
        if(tab === 'funeral') {
            ff.classList.remove('hidden');
            tf.className = 'flex-1 py-3 rounded-xl bg-red-600 font-bold text-sm';
        } else if(tab === 'mosque') {
            mf.classList.remove('hidden');
            tm.className = 'flex-1 py-3 rounded-xl bg-green-600 font-bold text-sm';
        } else if(tab === 'edit') {
            ef.classList.remove('hidden');
            te.className = 'flex-1 py-3 rounded-xl bg-blue-600 font-bold text-sm';
            updateEditMosqueSelect();
        }
    }

    function submitFuneral() {
        const pass = document.getElementById('adminPass').value;
        if(pass !== '2026') return showToast('Ú©Û†Ø¯ÛŒ Ø¦Û•Ø¯Ù…ÛŒÙ† Ù‡Û•ÚµÛ•ÛŒÛ•', 'error');
        
        if(!db) return showToast('Ø¦ÛŒÙ†ØªÛ•Ø±Ù†ÛØª Ù†ÛŒÛŒÛ•', 'error');
        const mid = document.getElementById('mosqueSelect').value;
        const name = document.getElementById('deceasedName').value.trim();
        const time = document.getElementById('prayerTime').value;
        if(!mid || !name || !time) return showToast('Ù¾Ú•Ø¨Ú©Û•Ø±Û•ÙˆÛ•', 'error');
        
        db.ref('funerals/' + mid).set({name, time, timestamp: Date.now()});
        document.getElementById('deceasedName').value = '';
        document.getElementById('prayerTime').value = '';
        showToast('Ø¨ÚµØ§ÙˆÚ©Ø±Ø§ÛŒÛ•ÙˆÛ•');
    }

    function submitMosque() {
        const pass = document.getElementById('adminPass').value;
        if(pass !== '2026') return showToast('Ú©Û†Ø¯ÛŒ Ø¦Û•Ø¯Ù…ÛŒÙ† Ù‡Û•ÚµÛ•ÛŒÛ•', 'error');
        
        if(!db) return showToast('Ø¦ÛŒÙ†ØªÛ•Ø±Ù†ÛØª Ù†ÛŒÛŒÛ•', 'error');
        const name = document.getElementById('mosqueName').value.trim();
        const lat = parseFloat(document.getElementById('mosqueLat').value);
        const lng = parseFloat(document.getElementById('mosqueLng').value);
        if(!name || isNaN(lat) || isNaN(lng)) return showToast('Ù¾Ú•Ø¨Ú©Û•Ø±Û•ÙˆÛ•', 'error');
        
        const ref = db.ref('customMosques').push();
        ref.set({id: ref.key, name, lat, lng});
        document.getElementById('mosqueName').value = '';
        document.getElementById('mosqueLat').value = '';
        document.getElementById('mosqueLng').value = '';
        showToast('Ù…Ø²Ú¯Û•ÙˆØª Ø²ÛŒØ§Ø¯Ú©Ø±Ø§');
    }

    function useCurrentLocation() {
        if(!userPos) return showToast('Ø´ÙˆÛÙ† Ù†Û•Ø¯Û†Ø²Ø±Ø§ÛŒÛ•ÙˆÛ•', 'error');
        document.getElementById('mosqueLat').value = userPos.lat.toFixed(6);
        document.getElementById('mosqueLng').value = userPos.lng.toFixed(6);
        showToast('Ø´ÙˆÛÙ†ÛŒ Ø¦ÛØ³ØªØ§ Ø¨Û•Ú©Ø§Ø±Ù‡ÛÙ†Ø±Ø§');
    }

    function updateAdminSelect() {
        const s = document.getElementById('mosqueSelect');
        s.innerHTML = '<option value="">Ù‡Û•ÚµØ¨Ú˜ÛØ±Û•</option>' + mosques.map(m => `<option value="${m.id}">${m.name}</option>`).join('');
    }

    function updateEditMosqueSelect() {
        const s = document.getElementById('editMosqueSelect');
        const customMosques = mosques.filter(m => m.id.startsWith('-') || m.id.includes('custom') || !BACKUP_MOSQUES.find(bm => bm.id === m.id));
        
        s.innerHTML = '<option value="">Ù…Ø²Ú¯Û•ÙˆØªÛÚ© Ù‡Û•ÚµØ¨Ú˜ÛØ±Û•...</option>' + 
            customMosques.map(m => `<option value="${m.id}">${m.name}</option>`).join('');
    }

    function loadMosqueForEdit() {
        const mosqueId = document.getElementById('editMosqueSelect').value;
        if(!mosqueId) {
            document.getElementById('editMosqueForm').classList.add('hidden');
            return;
        }
        
        const mosque = mosques.find(m => m.id === mosqueId);
        if(!mosque) return;
        
        document.getElementById('editMosqueName').value = mosque.name || '';
        document.getElementById('editMosqueLat').value = mosque.lat || '';
        document.getElementById('editMosqueLng').value = mosque.lng || '';
        document.getElementById('editMosqueDesc').value = mosque.description || '';
        
        document.getElementById('editMosqueForm').classList.remove('hidden');
    }

    function updateMosque() {
        const pass = document.getElementById('adminPass').value;
        if(pass !== '2026') return showToast('Ú©Û†Ø¯ÛŒ Ø¦Û•Ø¯Ù…ÛŒÙ† Ù‡Û•ÚµÛ•ÛŒÛ•', 'error');
        
        if(!db) return showToast('Ø¦ÛŒÙ†ØªÛ•Ø±Ù†ÛØª Ù†ÛŒÛŒÛ•', 'error');
        
        const mosqueId = document.getElementById('editMosqueSelect').value;
        if(!mosqueId) return showToast('Ù…Ø²Ú¯Û•ÙˆØªÛÚ© Ù‡Û•ÚµØ¨Ú˜ÛØ±Û•', 'error');
        
        const isCustom = mosqueId.startsWith('-') || mosqueId.includes('custom') || !BACKUP_MOSQUES.find(m => m.id === mosqueId);
        if(!isCustom) return showToast('ØªÛ•Ù†Ù‡Ø§ Ù…Ø²Ú¯Û•ÙˆØªÛ• Ø²ÛŒØ§Ø¯Ú©Ø±Ø§ÙˆÛ•Ú©Ø§Ù† Ø¯Û•ØªÙˆØ§Ù†Ø±ÛÙ† Ø¯Û•Ø³ØªÚ©Ø§Ø±ÛŒ Ø¨Ú©Ø±ÛÙ†', 'error');
        
        const name = document.getElementById('editMosqueName').value.trim();
        const lat = parseFloat(document.getElementById('editMosqueLat').value);
        const lng = parseFloat(document.getElementById('editMosqueLng').value);
        const description = document.getElementById('editMosqueDesc').value.trim();
        
        if(!name || isNaN(lat) || isNaN(lng)) return showToast('Ù¾Ú•Ø¨Ú©Û•Ø±Û•ÙˆÛ•', 'error');
        
        if(db) {
            db.ref('customMosques').orderByChild('id').equalTo(mosqueId).once('value', (snapshot) => {
                if(snapshot.exists()) {
                    const key = Object.keys(snapshot.val())[0];
                    db.ref('customMosques/' + key).update({
                        name: name,
                        lat: lat,
                        lng: lng,
                        description: description
                    });
                    showToast('Ù…Ø²Ú¯Û•ÙˆØª Ù†ÙˆÛÚ©Ø±Ø§ÛŒÛ•ÙˆÛ•');
                } else {
                    showToast('Ù…Ø²Ú¯Û•ÙˆØª Ù†Û•Ø¯Û†Ø²Ø±Ø§ÛŒÛ•ÙˆÛ•', 'error');
                }
            });
        }
    }

    function deleteMosque() {
        const pass = document.getElementById('adminPass').value;
        if(pass !== '2026') return showToast('Ú©Û†Ø¯ÛŒ Ø¦Û•Ø¯Ù…ÛŒÙ† Ù‡Û•ÚµÛ•ÛŒÛ•', 'error');
        
        if(!confirm('Ø¯ÚµÙ†ÛŒØ§ÛŒ Ù„Û• Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ø¦Û•Ù… Ù…Ø²Ú¯Û•ÙˆØªÛ•ØŸ')) return;
        
        const mosqueId = document.getElementById('editMosqueSelect').value;
        if(!mosqueId) return showToast('Ù…Ø²Ú¯Û•ÙˆØªÛÚ© Ù‡Û•ÚµØ¨Ú˜ÛØ±Û•', 'error');
        
        const isCustom = mosqueId.startsWith('-') || mosqueId.includes('custom') || !BACKUP_MOSQUES.find(m => m.id === mosqueId);
        if(!isCustom) return showToast('ØªÛ•Ù†Ù‡Ø§ Ù…Ø²Ú¯Û•ÙˆØªÛ• Ø²ÛŒØ§Ø¯Ú©Ø±Ø§ÙˆÛ•Ú©Ø§Ù† Ø¯Û•ØªÙˆØ§Ù†Ø±ÛÙ† Ø³Ú•Ø¯Ø±ÛÙ†Û•ÙˆÛ•', 'error');
        
        if(db) {
            db.ref('customMosques').orderByChild('id').equalTo(mosqueId).once('value', (snapshot) => {
                if(snapshot.exists()) {
                    const key = Object.keys(snapshot.val())[0];
                    db.ref('customMosques/' + key).remove()
                        .then(() => {
                            showToast('Ù…Ø²Ú¯Û•ÙˆØª Ø³Ú•Ø¯Ø±Ø§ÛŒÛ•ÙˆÛ•');
                            document.getElementById('editMosqueForm').classList.add('hidden');
                            document.getElementById('editMosqueSelect').value = '';
                        })
                        .catch(err => showToast('Ù‡Û•ÚµÛ•: ' + err.message, 'error'));
                }
            });
        }
    }

    function updateAdminFuneralList() {
        const list = document.getElementById('adminFuneralList');
        list.innerHTML = '';
        const count = Object.keys(funerals).length;
        if(count === 0) {
            list.innerHTML = '<div class="text-center text-gray-500 text-xs py-4">Ù‡ÛŒÚ† Ù¾Ø±Ø³Û•ÛŒÛ•Ú© Ù†ÛŒÛŒÛ•</div>';
            return;
        }
        Object.entries(funerals).forEach(([id, data]) => {
            const m = mosques.find(x => x.id == id);
            if(!m) return;
            const div = document.createElement('div');
            div.className = 'glass-light p-3 rounded-xl flex justify-between border-r-4 border-red-500/30 mb-2';
            div.innerHTML = `<div><p class="text-xs font-bold">${m.name}</p><p class="text-xs text-gray-400">${data.name} - ${data.time}</p></div><button onclick="deleteFuneral('${id}')" class="bg-red-500/20 px-3 py-1 rounded-lg text-red-400 text-xs"><i class="fas fa-trash"></i></button>`;
            list.appendChild(div);
        });
    }

    function deleteFuneral(id) {
        if(!confirm('Ø¯ÚµÙ†ÛŒØ§ÛŒØŸ')) return;
        if(db) {
            db.ref('funerals/' + id).remove();
            showToast('Ù¾Ø±Ø³Û• Ø³Ú•Ø¯Ø±Ø§ÛŒÛ•ÙˆÛ•');
        }
    }

    function autoDeleteOldFunerals() {
        if(!db) return;
        db.ref('funerals').once('value', (s) => {
            const d = s.val();
            if(!d) return;
            const now = Date.now();
            Object.entries(d).forEach(([id, f]) => {
                if(now - f.timestamp > 86400000) db.ref('funerals/' + id).remove();
            });
        });
    }

    function locateUser() {
        map.locate({setView: true, maxZoom: 16});
        showToast('Ú¯Û•Ú•Ø§Ù† Ø¨Û† Ø´ÙˆÛÙ†Û•Ú©Û•Øª...');
    }

    function shareLocation() {
        if(!selectedMosque) return showToast('Ù…Ø²Ú¯Û•ÙˆØªÛÚ© Ù‡Û•ÚµØ¨Ú˜ÛØ±Û•', 'error');
        const url = `https://www.google.com/maps/search/?api=1&query=${selectedMosque.lat},${selectedMosque.lng}`;
        if(navigator.share) {
            navigator.share({title: selectedMosque.name, url});
        } else {
            navigator.clipboard.writeText(url);
            showToast('Ù„ÛŒÙ†Ú©ÛŒ Ø´ÙˆÛÙ† Ú©Û†Ù¾ÛŒ Ú©Ø±Ø§');
        }
    }

    function shareApp() {
        const url = window.location.href;
        if(navigator.share) {
            navigator.share({title: 'Ù†Û•Ø®Ø´Û•ÛŒ Ø²ÛŒØ±Û•Ú©ÛŒ Ø­Ø§Ø¬ÛŒØ§ÙˆØ§', url});
        } else {
            navigator.clipboard.writeText(url);
            showToast('Ù„ÛŒÙ†Ú©ÛŒ Ø¦Û•Ù¾ Ú©Û†Ù¾ÛŒ Ú©Ø±Ø§');
        }
    }

    function toggleModal(id) {
        const m = document.getElementById(id);
        if(m.style.display === 'flex') {
            m.style.display = 'none';
        } else {
            m.style.display = 'flex';
            if(id === 'adminModal') {
                updateAdminSelect();
                updateAdminFuneralList();
            }
        }
    }

    function showToast(msg, type='success') {
        const t = document.getElementById('toastNotif');
        const i = document.getElementById('toastIcon');
        const m = document.getElementById('toastMessage');
        
        i.className = type === 'error' ? 'fas fa-exclamation-circle text-red-400 text-xl' : 'fas fa-check-circle text-green-400 text-xl';
        m.textContent = msg;
        t.classList.add('show');
        setTimeout(() => t.classList.remove('show'), 3000);
    }
</script>

</body>
</html>
